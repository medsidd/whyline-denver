{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.5", "generated_at": "2025-11-10T03:11:48.896346Z", "invocation_id": "cf185a6b-86ef-431e-a331-dd3d09096cd8", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T03:10:48.630027Z", "completed_at": "2025-11-10T03:10:48.642665Z"}, {"name": "execute", "started_at": "2025-11-10T03:10:48.643216Z", "completed_at": "2025-11-10T03:10:49.562838Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9338529109954834, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "whyline-denver", "job_id": "185771f6-6e7d-485a-94e5-595da395d6a6", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.whylinedenver_dbt.stg_rt_events", "compiled": true, "compiled_code": "\n\n\n\n\nwith trips as (\n    select\n        trip_id,\n        direction_id,\n        trip_headsign\n    from `whyline-denver`.`stg_denver`.`stg_gtfs_trips`\n),\nscheduled as (\n    select\n        trip_id,\n        stop_id,\n        stop_sequence,\n        sched_arrival_ts_mst,\n        sched_departure_ts_mst,\n        service_date_mst\n    from `whyline-denver`.`stg_denver`.`int_scheduled_arrivals`\n),\ntu as (\n    select\n        feed_ts_utc,\n        entity_id as tu_entity_id,\n        trip_id,\n        route_id,\n        stop_id,\n        stop_sequence,\n        arrival_delay_sec as arrival_delay_sec_raw,\n        departure_delay_sec as departure_delay_sec_raw,\n        schedule_relationship,\n        event_ts_utc as tu_event_ts_utc\n    from `whyline-denver`.`raw_denver`.`raw_gtfsrt_trip_updates`\n    where feed_ts_utc >= timestamp_sub(current_timestamp(), interval 45 day)\n),\nvp as (\n    select\n        feed_ts_utc,\n        entity_id as vp_entity_id,\n        trip_id,\n        route_id,\n        vehicle_id,\n        vehicle_label,\n        lon,\n        lat,\n        bearing,\n        speed_mps,\n        event_ts_utc as vp_event_ts_utc\n    from `whyline-denver`.`raw_denver`.`raw_gtfsrt_vehicle_positions`\n    where feed_ts_utc >= timestamp_sub(current_timestamp(), interval 45 day)\n),\nj as (\n    select\n        coalesce(tu.feed_ts_utc, vp.feed_ts_utc) as feed_ts_utc,\n        coalesce(tu.trip_id, vp.trip_id) as trip_id,\n        coalesce(tu.route_id, vp.route_id) as route_id,\n        tu.tu_entity_id,\n        vp.vp_entity_id,\n        tu.stop_id,\n        tu.stop_sequence,\n        tu.arrival_delay_sec_raw,\n        tu.departure_delay_sec_raw,\n        tu.schedule_relationship,\n        vp.vehicle_id,\n        vp.vehicle_label,\n        vp.lon,\n        vp.lat,\n        vp.bearing,\n        vp.speed_mps,\n        \n    ST_GEOGPOINT(CAST(vp.lon AS FLOAT64), CAST(vp.lat AS FLOAT64))\n as geom,\n        coalesce(tu.tu_event_ts_utc, vp.vp_event_ts_utc, coalesce(tu.feed_ts_utc, vp.feed_ts_utc)) as event_ts_utc\n    from tu\n    full outer join vp\n        on tu.feed_ts_utc = vp.feed_ts_utc\n        and tu.trip_id = vp.trip_id\n        and tu.route_id = vp.route_id\n),\nranked as (\n    select\n        *,\n        row_number() over (\n            partition by feed_ts_utc, trip_id\n            order by event_ts_utc desc, tu_entity_id desc, vp_entity_id desc\n        ) as trip_rank\n    from j\n)\nselect\n    r.feed_ts_utc,\n    r.trip_id,\n    r.route_id,\n    r.tu_entity_id,\n    r.vp_entity_id,\n    r.stop_id,\n    r.stop_sequence,\n    -- Use raw delay values if available, otherwise calculate from schedule\n    coalesce(\n        r.arrival_delay_sec_raw,\n        case\n            when s.sched_arrival_ts_mst is not null and r.event_ts_utc is not null\n            then timestamp_diff(r.event_ts_utc, s.sched_arrival_ts_mst, second)\n        end\n    ) as arrival_delay_sec,\n    coalesce(\n        r.departure_delay_sec_raw,\n        case\n            when s.sched_departure_ts_mst is not null and r.event_ts_utc is not null\n            then timestamp_diff(r.event_ts_utc, s.sched_departure_ts_mst, second)\n        end\n    ) as departure_delay_sec,\n    r.schedule_relationship,\n    r.vehicle_id,\n    r.vehicle_label,\n    r.lon,\n    r.lat,\n    r.bearing,\n    r.speed_mps,\n    r.geom,\n    r.event_ts_utc,\n    t.direction_id,\n    t.trip_headsign,\n    \n    DATE(r.event_ts_utc, \"America/Denver\")\n as event_date_mst,\n    \n    EXTRACT(HOUR FROM DATETIME(r.event_ts_utc, \"America/Denver\"))\n as event_hour_mst\nfrom ranked as r\nleft join trips as t\n    on r.trip_id = t.trip_id\nleft join scheduled as s\n    on r.trip_id = s.trip_id\n    and r.stop_id = s.stop_id\n    and r.stop_sequence = s.stop_sequence\n    and s.service_date_mst = \n    DATE(r.event_ts_utc, \"America/Denver\")\n\nwhere r.trip_rank = 1", "relation_name": "`whyline-denver`.`stg_denver`.`stg_rt_events`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T03:10:49.567280Z", "completed_at": "2025-11-10T03:10:49.570703Z"}, {"name": "execute", "started_at": "2025-11-10T03:10:49.571017Z", "completed_at": "2025-11-10T03:10:50.559599Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.993093729019165, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "whyline-denver", "job_id": "a561df29-0c40-4f88-8034-29d0f6196eb7", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.whylinedenver_dbt.int_rt_events_resolved", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        route_id,\n        trip_id,\n        stop_id,\n        direction_id,\n        event_date_mst as service_date_mst,\n        event_hour_mst,\n        event_ts_utc,\n        arrival_delay_sec,\n        departure_delay_sec,\n        coalesce(arrival_delay_sec, departure_delay_sec) as delay_sec_raw,\n        coalesce(arrival_delay_sec, departure_delay_sec, 0) as delay_sec\n    from `whyline-denver`.`stg_denver`.`stg_rt_events`\n)\n\nselect\n    route_id,\n    trip_id,\n    stop_id,\n    direction_id,\n    service_date_mst,\n    event_hour_mst,\n    event_ts_utc,\n    delay_sec,\n    delay_sec_raw,\n    case\n        when abs(delay_sec) <= 300 then 1\n        else 0\n    end as is_on_time\nfrom base", "relation_name": "`whyline-denver`.`stg_denver`.`int_rt_events_resolved`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T03:10:50.562969Z", "completed_at": "2025-11-10T03:10:50.569351Z"}, {"name": "execute", "started_at": "2025-11-10T03:10:50.569763Z", "completed_at": "2025-11-10T03:10:51.640377Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0781400203704834, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "whyline-denver", "job_id": "706e6323-9bc1-48cb-9d8a-d52edfe34c56", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.whylinedenver_dbt.stg_rt_events_daily_stats", "compiled": true, "compiled_code": "\n\nselect\n    \n    DATE(feed_ts_utc, \"America/Denver\")\n as feed_date_mst,\n    count(*) as event_rows,\n    count(distinct trip_id) as trips_observed,\n    count(distinct route_id) as routes_observed,\n    min(feed_ts_utc) as first_feed_ts_utc,\n    max(feed_ts_utc) as last_feed_ts_utc\nfrom `whyline-denver`.`stg_denver`.`stg_rt_events`\ngroup by 1", "relation_name": "`whyline-denver`.`stg_denver`.`stg_rt_events_daily_stats`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T03:10:51.643240Z", "completed_at": "2025-11-10T03:10:51.646324Z"}, {"name": "execute", "started_at": "2025-11-10T03:10:51.646698Z", "completed_at": "2025-11-10T03:10:52.650866Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0083308219909668, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "whyline-denver", "job_id": "5da36d48-6f1d-42d8-9e62-c164d4d860df", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.whylinedenver_dbt.int_stop_headways_observed", "compiled": true, "compiled_code": "\n\n\n\n\nwith base as (\n    select\n        route_id,\n        direction_id,\n        stop_id,\n        service_date_mst,\n        event_ts_utc\n    from `whyline-denver`.`stg_denver`.`int_rt_events_resolved`\n    where event_ts_utc is not null\n        and service_date_mst >= date_sub(current_date(\"America/Denver\"), interval 45 day)\n),\ndeduped as (\n    select\n        route_id,\n        direction_id,\n        stop_id,\n        service_date_mst,\n        event_ts_utc\n    from (\n        select\n            *,\n            row_number() over (\n                partition by route_id, direction_id, stop_id, service_date_mst, event_ts_utc\n                order by event_ts_utc\n            ) as event_rank\n        from base\n    )\n    where event_rank = 1\n)\n\nselect\n    route_id,\n    direction_id,\n    stop_id,\n    service_date_mst,\n    event_ts_utc,\n    timestamp_diff(\n        event_ts_utc,\n        lag(event_ts_utc) over (\n            partition by route_id, direction_id, stop_id, service_date_mst\n            order by event_ts_utc\n        ),\n        second\n    ) as obs_headway_sec\nfrom deduped", "relation_name": "`whyline-denver`.`stg_denver`.`int_stop_headways_observed`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T03:10:52.654776Z", "completed_at": "2025-11-10T03:10:52.663397Z"}, {"name": "execute", "started_at": "2025-11-10T03:10:52.663863Z", "completed_at": "2025-11-10T03:11:11.727278Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 19.0733859539032, "adapter_response": {"_message": "CREATE TABLE (2.0k rows, 2.7 GiB processed)", "code": "CREATE TABLE", "rows_affected": 2028, "bytes_processed": 2852561316, "bytes_billed": 2853175296, "location": "US", "project_id": "whyline-denver", "job_id": "5df27c2b-f715-4702-a70c-a8f97425370b", "slot_ms": 405189}, "message": "CREATE TABLE (2.0k rows, 2.7 GiB processed)", "failures": null, "unique_id": "model.whylinedenver_dbt.mart_reliability_by_route_day", "compiled": true, "compiled_code": "\n\nwith e as (\n    select\n        route_id,\n        service_date_mst,\n        delay_sec,\n        delay_sec_raw\n    from `whyline-denver`.`stg_denver`.`int_rt_events_resolved`\n    where true\n    \n),\nw as (\n    select\n        service_date_mst,\n        precip_bin,\n        snow_day\n    from `whyline-denver`.`stg_denver`.`int_weather_by_date`\n)\n\nselect\n    e.route_id,\n    e.service_date_mst,\n    coalesce(w.precip_bin, 'none') as precip_bin,\n    coalesce(w.snow_day, false) as snow_day,\n    count(*) as n_events,\n    countif(delay_sec_raw is not null) as n_reported_events,\n    avg(case when abs(delay_sec) <= 300 then 1 else 0 end) as pct_on_time,\n    avg(delay_sec) as mean_delay_sec,\n    approx_quantiles(delay_sec, 100)[offset(50)] as median_delay_sec,\n    approx_quantiles(delay_sec, 100)[offset(90)] as p90_delay_sec,\n    current_timestamp() as build_run_at\nfrom e\nleft join w\n    using (service_date_mst)\ngroup by\n    route_id,\n    service_date_mst,\n    precip_bin,\n    snow_day", "relation_name": "`whyline-denver`.`mart_denver`.`mart_reliability_by_route_day`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T03:11:11.732942Z", "completed_at": "2025-11-10T03:11:11.738936Z"}, {"name": "execute", "started_at": "2025-11-10T03:11:11.739321Z", "completed_at": "2025-11-10T03:11:12.808680Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0766470432281494, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "whyline-denver", "job_id": "20b7c421-287d-4c41-99da-7945ebfc8dc6", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.whylinedenver_dbt.int_rt_daily_coverage", "compiled": true, "compiled_code": "\n\nselect\n    feed_date_mst,\n    event_rows,\n    trips_observed,\n    routes_observed,\n    current_timestamp() as build_run_at\nfrom `whyline-denver`.`stg_denver`.`stg_rt_events_daily_stats`", "relation_name": "`whyline-denver`.`stg_denver`.`int_rt_daily_coverage`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T03:11:12.813049Z", "completed_at": "2025-11-10T03:11:12.821224Z"}, {"name": "execute", "started_at": "2025-11-10T03:11:12.821583Z", "completed_at": "2025-11-10T03:11:27.565491Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 14.753534317016602, "adapter_response": {"_message": "CREATE TABLE (0.0 rows, 2.7 GiB processed)", "code": "CREATE TABLE", "rows_affected": 0, "bytes_processed": 2860155461, "bytes_billed": 2860515328, "location": "US", "project_id": "whyline-denver", "job_id": "92092df9-b64c-4c6b-a016-793c48682e79", "slot_ms": 613384}, "message": "CREATE TABLE (0.0 rows, 2.7 GiB processed)", "failures": null, "unique_id": "model.whylinedenver_dbt.int_headway_adherence", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith obs as (\n    select\n        route_id,\n        direction_id,\n        stop_id,\n        service_date_mst,\n        event_ts_utc,\n        obs_headway_sec\n    from `whyline-denver`.`stg_denver`.`int_stop_headways_observed`\n    where obs_headway_sec is not null\n    \n        and service_date_mst >= date_sub(current_date(\"America/Denver\"), interval 45 day)\n    \n),\nsch as (\n    select\n        route_id,\n        direction_id,\n        stop_id,\n        service_date_mst,\n        sched_arrival_ts_mst,\n        sch_headway_sec\n    from `whyline-denver`.`stg_denver`.`int_stop_headways_scheduled`\n    where sch_headway_sec is not null\n    \n),\nnearest as (\n    select\n        o.route_id,\n        o.direction_id,\n        o.stop_id,\n        o.service_date_mst,\n        o.event_ts_utc,\n        o.obs_headway_sec,\n        s.sch_headway_sec,\n        abs(timestamp_diff(o.event_ts_utc, s.sched_arrival_ts_mst, second)) as dt_abs\n    from obs as o\n    join sch as s\n        on o.route_id = s.route_id\n        and coalesce(o.direction_id, -1) = coalesce(s.direction_id, -1)\n        and o.stop_id = s.stop_id\n        and o.service_date_mst = s.service_date_mst\n    qualify row_number() over (\n        partition by o.route_id, o.direction_id, o.stop_id, o.service_date_mst, o.event_ts_utc\n        order by dt_abs\n    ) = 1\n)\n\nselect\n    route_id,\n    direction_id,\n    stop_id,\n    service_date_mst,\n    event_ts_utc,\n    obs_headway_sec,\n    sch_headway_sec,\n    dt_abs,\n    case\n        when dt_abs <= 1800\n         and sch_headway_sec > 0\n         and abs(obs_headway_sec - sch_headway_sec) / sch_headway_sec <= 0.5\n        then 1\n        else 0\n    end as headway_adherent\nfrom nearest", "relation_name": "`whyline-denver`.`stg_denver`.`int_headway_adherence`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T03:11:27.571142Z", "completed_at": "2025-11-10T03:11:27.575724Z"}, {"name": "execute", "started_at": "2025-11-10T03:11:27.576100Z", "completed_at": "2025-11-10T03:11:30.040637Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.470428228378296, "adapter_response": {"_message": "CREATE TABLE (124.0 rows, 37.0 KiB processed)", "code": "CREATE TABLE", "rows_affected": 124, "bytes_processed": 37846, "bytes_billed": 10485760, "location": "US", "project_id": "whyline-denver", "job_id": "007bf738-0fac-41cf-9af5-16c64b1cf0df", "slot_ms": 8745}, "message": "CREATE TABLE (124.0 rows, 37.0 KiB processed)", "failures": null, "unique_id": "model.whylinedenver_dbt.mart_weather_impacts", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        route_id,\n        precip_bin,\n        pct_on_time\n    from `whyline-denver`.`mart_denver`.`mart_reliability_by_route_day`\n),\navgd as (\n    select\n        route_id,\n        precip_bin,\n        avg(pct_on_time) as pct_on_time_avg\n    from base\n    group by\n        route_id,\n        precip_bin\n),\nnorm as (\n    select\n        a.route_id,\n        a.precip_bin,\n        a.pct_on_time_avg,\n        n.pct_on_time_avg as pct_on_time_normal\n    from avgd as a\n    left join avgd as n\n        on a.route_id = n.route_id\n        and n.precip_bin = 'none'\n)\n\nselect\n    route_id,\n    precip_bin,\n    pct_on_time_avg,\n    pct_on_time_normal,\n    pct_on_time_avg - pct_on_time_normal as delta_pct_on_time,\n    current_timestamp() as build_run_at\nfrom norm", "relation_name": "`whyline-denver`.`mart_denver`.`mart_weather_impacts`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T03:11:30.043413Z", "completed_at": "2025-11-10T03:11:30.047138Z"}, {"name": "execute", "started_at": "2025-11-10T03:11:30.047567Z", "completed_at": "2025-11-10T03:11:44.296354Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 14.25364375114441, "adapter_response": {"_message": "CREATE TABLE (70.0k rows, 2.7 GiB processed)", "code": "CREATE TABLE", "rows_affected": 70011, "bytes_processed": 2852526424, "bytes_billed": 2853175296, "location": "US", "project_id": "whyline-denver", "job_id": "6d71a34a-1744-4d11-8f91-c9aa7a250b40", "slot_ms": 790101}, "message": "CREATE TABLE (70.0k rows, 2.7 GiB processed)", "failures": null, "unique_id": "model.whylinedenver_dbt.mart_reliability_by_stop_hour", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        stop_id,\n        route_id,\n        service_date_mst,\n        event_hour_mst,\n        delay_sec\n    from `whyline-denver`.`stg_denver`.`int_rt_events_resolved`\n    where stop_id is not null\n    \n),\nhead AS (\n    select\n        stop_id,\n        service_date_mst,\n        extract(hour from event_ts_utc at time zone \"America/Denver\") as event_hour_mst,\n        avg(headway_adherent) as headway_adherence_rate,\n        approx_quantiles(obs_headway_sec, 100)[offset(50)] as obs_headway_sec_p50,\n        approx_quantiles(obs_headway_sec, 100)[offset(90)] as obs_headway_sec_p90\n    from `whyline-denver`.`stg_denver`.`int_headway_adherence`\n    group by\n        stop_id,\n        service_date_mst,\n        event_hour_mst\n),\nagg as (\n    select\n        stop_id,\n        service_date_mst,\n        event_hour_mst,\n        count(*) as n_events,\n        avg(case when abs(delay_sec) <= 300 then 1 else 0 end) as pct_on_time,\n        avg(delay_sec) as mean_delay_sec,\n        approx_quantiles(delay_sec, 100)[offset(90)] as p90_delay_sec\n    from base\n    group by\n        stop_id,\n        service_date_mst,\n        event_hour_mst\n),\nroute_mode as (\n    select\n        stop_id,\n        service_date_mst,\n        event_hour_mst,\n        array_agg(route_id order by route_events desc, route_id limit 1)[offset(0)] as route_id_mode\n    from (\n        select\n            stop_id,\n            service_date_mst,\n            event_hour_mst,\n            route_id,\n            count(*) as route_events\n        from base\n        where route_id is not null\n        group by\n            stop_id,\n            service_date_mst,\n            event_hour_mst,\n            route_id\n    )\n    group by\n        stop_id,\n        service_date_mst,\n        event_hour_mst\n)\n\nselect\n    a.stop_id,\n    a.service_date_mst,\n    a.event_hour_mst,\n    a.n_events,\n    a.pct_on_time,\n    a.mean_delay_sec,\n    a.p90_delay_sec,\n    coalesce(rm.route_id_mode, 'unknown') as route_id_mode,\n    h.headway_adherence_rate,\n    h.obs_headway_sec_p50,\n    h.obs_headway_sec_p90,\n    current_timestamp() as build_run_at\nfrom agg as a\nleft join head as h\n    using (stop_id, service_date_mst, event_hour_mst)\nleft join route_mode as rm\n    using (stop_id, service_date_mst, event_hour_mst)", "relation_name": "`whyline-denver`.`mart_denver`.`mart_reliability_by_stop_hour`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-10T03:11:44.301138Z", "completed_at": "2025-11-10T03:11:44.306536Z"}, {"name": "execute", "started_at": "2025-11-10T03:11:44.307048Z", "completed_at": "2025-11-10T03:11:48.890844Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.590471982955933, "adapter_response": {"_message": "CREATE TABLE (7.5k rows, 1.7 MiB processed)", "code": "CREATE TABLE", "rows_affected": 7513, "bytes_processed": 1800947, "bytes_billed": 31457280, "location": "US", "project_id": "whyline-denver", "job_id": "1f1e4e82-7232-4642-ad3f-d0a15b075824", "slot_ms": 52518}, "message": "CREATE TABLE (7.5k rows, 1.7 MiB processed)", "failures": null, "unique_id": "model.whylinedenver_dbt.mart_priority_hotspots", "compiled": true, "compiled_code": "\n\nwith rel as (\n    select\n        stop_id,\n        100.0 * (1 - avg(pct_on_time)) as reliability_score_0_100\n    from `whyline-denver`.`mart_denver`.`mart_reliability_by_stop_hour`\n    where service_date_mst >= date_sub(current_date(\"America/Denver\"), interval 35 day)\n    group by stop_id\n),\ncr as (\n    select\n        stop_id,\n        cast(\n            round(\n                (crash_250m_cnt - min(crash_250m_cnt) over ()) /\n                nullif(\n                    max(crash_250m_cnt) over () - min(crash_250m_cnt) over (),\n                    0\n                ) * 100,\n                1\n            ) as float64\n        ) as crash_score_0_100\n    from `whyline-denver`.`mart_denver`.`mart_crash_proximity_by_stop`\n),\nv as (\n    select\n        stop_id,\n        vuln_score_0_100\n    from `whyline-denver`.`mart_denver`.`mart_vulnerability_by_stop`\n),\njoined as (\n    select\n        coalesce(v.stop_id, cr.stop_id, rel.stop_id) as stop_id,\n        v.vuln_score_0_100,\n        cr.crash_score_0_100,\n        rel.reliability_score_0_100\n    from v\n    full outer join cr\n        using (stop_id)\n    full outer join rel\n        using (stop_id)\n),\nscored as (\n    select\n        stop_id,\n        vuln_score_0_100,\n        crash_score_0_100,\n        reliability_score_0_100,\n        0.5 * coalesce(vuln_score_0_100, 0)\n        + 0.3 * coalesce(crash_score_0_100, 0)\n        + 0.2 * coalesce(reliability_score_0_100, 0) as priority_score\n    from joined\n)\n\nselect\n    stop_id,\n    vuln_score_0_100,\n    crash_score_0_100,\n    reliability_score_0_100,\n    priority_score,\n    dense_rank() over (order by priority_score desc) as priority_rank,\n    current_timestamp() as build_run_at\nfrom scored\nwhere stop_id is not null", "relation_name": "`whyline-denver`.`mart_denver`.`mart_priority_hotspots`"}], "elapsed_time": 61.607199907302856, "args": {"strict_mode": false, "show_resource_report": false, "enable_legacy_logger": false, "version_check": true, "invocation_command": "dbt run --target prod --select stg_rt_events+ --full-refresh", "target": "prod", "empty": false, "static_parser": true, "source_freshness_run_project_hooks": false, "require_explicit_package_overrides_for_builtin_materializations": true, "write_json": true, "partial_parse": true, "favor_state": false, "macro_debugging": false, "log_path": "/Users/medsidd/Desktop/whyline-denver/dbt/logs", "indirect_selection": "eager", "log_level_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "use_colors": true, "log_file_max_bytes": 10485760, "profiles_dir": "/Users/medsidd/Desktop/whyline-denver/dbt/profiles", "vars": {}, "introspect": true, "project_dir": "/Users/medsidd/Desktop/whyline-denver/dbt", "quiet": false, "which": "run", "defer": false, "log_format": "default", "select": ["stg_rt_events+"], "exclude": [], "log_format_file": "debug", "log_level": "info", "partial_parse_file_diff": true, "require_resource_names_without_spaces": false, "full_refresh": true, "use_colors_file": true, "printer_width": 80, "print": true, "send_anonymous_usage_stats": true, "populate_cache": true, "cache_selected_only": false}}