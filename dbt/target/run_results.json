{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.5", "generated_at": "2025-10-23T17:38:44.767054Z", "invocation_id": "46258c28-cc5c-43d5-a648-d34b2f3b83fe", "env": {}}, "results": [{"status": "error", "timing": [{"name": "compile", "started_at": "2025-10-23T17:38:44.508722Z", "completed_at": "2025-10-23T17:38:44.513742Z"}, {"name": "execute", "started_at": "2025-10-23T17:38:44.513984Z", "completed_at": "2025-10-23T17:38:44.543732Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04351520538330078, "adapter_response": {}, "message": "Runtime Error in model stg_acs_geo (models/staging/stg_acs_geo.sql)\n  Binder Error: Catalog \"demo-project\" does not exist!", "failures": null, "unique_id": "model.whylinedenver_dbt.stg_acs_geo", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        geoid,\n        name,\n        year,\n        hh_no_vehicle,\n        hh_total,\n        workers_transit,\n        workers_total,\n        persons_poverty,\n        pop_total,\n        pct_hh_no_vehicle,\n        pct_transit_commute,\n        pct_poverty,\n        _ingested_at\n    from \"demo-project\".\"raw_denver\".\"raw_acs_tract\"\n),\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by geoid\n            order by year desc, _ingested_at desc\n        ) as tract_rank\n    from base\n)\n\nselect\n    geoid,\n    name,\n    year,\n    hh_no_vehicle,\n    hh_total,\n    workers_transit,\n    workers_total,\n    persons_poverty,\n    pop_total,\n    pct_hh_no_vehicle,\n    pct_transit_commute,\n    pct_poverty\nfrom deduped\nwhere tract_rank = 1", "relation_name": "\"warehouse\".\"stg_local\".\"stg_acs_geo\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-10-23T17:38:44.554745Z", "completed_at": "2025-10-23T17:38:44.558632Z"}, {"name": "execute", "started_at": "2025-10-23T17:38:44.558962Z", "completed_at": "2025-10-23T17:38:44.573356Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023169755935668945, "adapter_response": {}, "message": "Runtime Error in model stg_denver_crashes (models/staging/stg_denver_crashes.sql)\n  Parser Error: Wrong number of arguments provided to DATE function", "failures": null, "unique_id": "model.whylinedenver_dbt.stg_denver_crashes", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        crash_id,\n        event_ts_utc,\n        severity,\n        severity_text,\n        lon,\n        lat,\n        roadway_name,\n        on_route,\n        off_route,\n        bike_involved,\n        ped_involved\n    from \"demo-project\".\"raw_denver\".\"raw_crashes\"\n    where lon is not null\n      and lat is not null\n),\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by crash_id\n            order by event_ts_utc desc, severity desc\n        ) as crash_rank\n    from base\n)\nselect\n    crash_id,\n    event_ts_utc,\n    severity,\n    severity_text,\n    \n    ST_GEOGPOINT(CAST(lon AS FLOAT64), CAST(lat AS FLOAT64))\n as geom,\n    roadway_name,\n    on_route,\n    off_route,\n    bike_involved,\n    ped_involved,\n    \n    DATE(event_ts_utc, \"America/Denver\")\n as event_date_mst,\n    \n    EXTRACT(HOUR FROM DATETIME(event_ts_utc, \"America/Denver\"))\n as event_hour_mst\nfrom deduped\nwhere crash_rank = 1", "relation_name": "\"warehouse\".\"stg_local\".\"stg_denver_crashes\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-10-23T17:38:44.579574Z", "completed_at": "2025-10-23T17:38:44.583445Z"}, {"name": "execute", "started_at": "2025-10-23T17:38:44.583714Z", "completed_at": "2025-10-23T17:38:44.596593Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02086329460144043, "adapter_response": {}, "message": "Runtime Error in model stg_denver_tracts (models/staging/stg_denver_tracts.sql)\n  Binder Error: Catalog \"demo-project\" does not exist!", "failures": null, "unique_id": "model.whylinedenver_dbt.stg_denver_tracts", "compiled": true, "compiled_code": "\n\n\n    \n\n\nwith ranked as (\n    select\n        geoid,\n        name,\n        aland_m2,\n        awater_m2,\n        geometry_geojson,\n        _ingested_at,\n        row_number() over (\n            partition by geoid\n            order by _ingested_at desc\n        ) as record_rank\n    from \"demo-project\".\"raw_denver\".\"raw_denver_tracts\"\n)\n\nselect\n    geoid,\n    name,\n    aland_m2,\n    awater_m2,\n    ST_GEOGFROMGEOJSON(geometry_geojson) as geom\nfrom ranked\nwhere record_rank = 1", "relation_name": "\"warehouse\".\"stg_local\".\"stg_denver_tracts\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-10-23T17:38:44.602178Z", "completed_at": "2025-10-23T17:38:44.636145Z"}, {"name": "execute", "started_at": "2025-10-23T17:38:44.636361Z", "completed_at": "2025-10-23T17:38:44.646108Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04826498031616211, "adapter_response": {}, "message": "Runtime Error in model stg_gtfs_routes (models/staging/stg_gtfs_routes.sql)\n  Binder Error: Catalog \"demo-project\" does not exist!", "failures": null, "unique_id": "model.whylinedenver_dbt.stg_gtfs_routes", "compiled": true, "compiled_code": "\n\nwith deduped as (\n    select\n        route_id,\n        coalesce(nullif(route_short_name, ''), route_long_name) as route_name,\n        route_long_name,\n        route_type,\n        route_desc,\n        TRUE as is_active,\n        row_number() over (\n            partition by route_id\n            order by route_long_name, route_desc, route_short_name\n        ) as route_rank\n    from \"demo-project\".\"raw_denver\".\"raw_gtfs_routes\"\n)\n\nselect\n    route_id,\n    route_name,\n    route_long_name,\n    route_type,\n    route_desc,\n    is_active\nfrom deduped\nwhere route_rank = 1", "relation_name": "\"warehouse\".\"stg_local\".\"stg_gtfs_routes\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-10-23T17:38:44.651839Z", "completed_at": "2025-10-23T17:38:44.653790Z"}, {"name": "execute", "started_at": "2025-10-23T17:38:44.653983Z", "completed_at": "2025-10-23T17:38:44.664875Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01735091209411621, "adapter_response": {}, "message": "Runtime Error in model stg_gtfs_stop_times (models/staging/stg_gtfs_stop_times.sql)\n  Parser Error: syntax error at or near \"offset\"\n  \n  LINE 19:         split(arrival_time, ':')[offset(0)] as a_h,\n                                            ^", "failures": null, "unique_id": "model.whylinedenver_dbt.stg_gtfs_stop_times", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        trip_id,\n        stop_id,\n        stop_sequence,\n        arrival_time,\n        departure_time\n    from \"demo-project\".\"raw_denver\".\"raw_gtfs_stop_times\"\n),\nnorm as (\n    select\n        *,\n        split(arrival_time, ':')[offset(0)] as a_h,\n        split(arrival_time, ':')[offset(1)] as a_m,\n        split(arrival_time, ':')[offset(2)] as a_s,\n        split(departure_time, ':')[offset(0)] as d_h,\n        split(departure_time, ':')[offset(1)] as d_m,\n        split(departure_time, ':')[offset(2)] as d_s\n    from base\n)\nselect\n    trip_id,\n    stop_id,\n    stop_sequence,\n    arrival_time,\n    departure_time,\n    cast(a_h as int64) as arr_hour_gtfs,\n    cast(d_h as int64) as dep_hour_gtfs,\n    case\n        when cast(a_h as int64) is null then null\n        else cast(a_h as int64)\n    end as arr_hour_bucket\nfrom norm", "relation_name": "\"warehouse\".\"stg_local\".\"stg_gtfs_stop_times\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-10-23T17:38:44.670705Z", "completed_at": "2025-10-23T17:38:44.673382Z"}, {"name": "execute", "started_at": "2025-10-23T17:38:44.673577Z", "completed_at": "2025-10-23T17:38:44.683819Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017440080642700195, "adapter_response": {}, "message": "Runtime Error in model stg_gtfs_stops (models/staging/stg_gtfs_stops.sql)\n  Parser Error: syntax error at or near \"AS\"\n  \n  LINE 17:     SAFE_CAST(wheelchair_boarding AS INT64)\n                                             ^", "failures": null, "unique_id": "model.whylinedenver_dbt.stg_gtfs_stops", "compiled": true, "compiled_code": "\n\nwith ranked_stops as (\n    select\n        stop_id,\n        stop_name,\n        stop_lat,\n        stop_lon,\n        \n    ST_GEOGPOINT(CAST(stop_lon AS FLOAT64), CAST(stop_lat AS FLOAT64))\n as geom,\n        \n    SAFE_CAST(wheelchair_boarding AS INT64)\n as wheelchair_boarding,\n        row_number() over (\n            partition by stop_id\n            order by stop_name, stop_lat, stop_lon\n        ) as stop_rank\n    from \"demo-project\".\"raw_denver\".\"raw_gtfs_stops\"\n)\n\nselect\n    stop_id,\n    stop_name,\n    stop_lat,\n    stop_lon,\n    geom,\n    wheelchair_boarding\nfrom ranked_stops\nwhere stop_rank = 1", "relation_name": "\"warehouse\".\"stg_local\".\"stg_gtfs_stops\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-10-23T17:38:44.689979Z", "completed_at": "2025-10-23T17:38:44.693021Z"}, {"name": "execute", "started_at": "2025-10-23T17:38:44.693377Z", "completed_at": "2025-10-23T17:38:44.704452Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018815040588378906, "adapter_response": {}, "message": "Runtime Error in model stg_gtfs_trips (models/staging/stg_gtfs_trips.sql)\n  Parser Error: RESPECT/IGNORE NULLS is not supported for non-window functions", "failures": null, "unique_id": "model.whylinedenver_dbt.stg_gtfs_trips", "compiled": true, "compiled_code": "\n\nwith cal as (\n    select\n        service_id,\n        start_date,\n        end_date,\n        monday,\n        tuesday,\n        wednesday,\n        thursday,\n        friday,\n        saturday,\n        sunday\n    from \"demo-project\".\"raw_denver\".\"raw_gtfs_calendar\"\n),\nex as (\n    select\n        service_id,\n        array_agg(case when exception_type = 1 then date end ignore nulls) as added_service_dates,\n        array_agg(case when exception_type = 2 then date end ignore nulls) as removed_service_dates\n    from \"demo-project\".\"raw_denver\".\"raw_gtfs_calendar_dates\"\n    group by service_id\n),\ntr as (\n    select\n        trip_id,\n        route_id,\n        service_id,\n        direction_id,\n        shape_id,\n        trip_headsign\n    from \"demo-project\".\"raw_denver\".\"raw_gtfs_trips\"\n)\nselect\n    tr.trip_id,\n    tr.route_id,\n    tr.service_id,\n    tr.direction_id,\n    tr.shape_id,\n    tr.trip_headsign,\n    cal.start_date,\n    cal.end_date,\n    cal.monday,\n    cal.tuesday,\n    cal.wednesday,\n    cal.thursday,\n    cal.friday,\n    cal.saturday,\n    cal.sunday,\n    ex.added_service_dates,\n    ex.removed_service_dates\nfrom tr\nleft join cal using (service_id)\nleft join ex using (service_id)", "relation_name": "\"warehouse\".\"stg_local\".\"stg_gtfs_trips\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-10-23T17:38:44.710857Z", "completed_at": "2025-10-23T17:38:44.713090Z"}, {"name": "execute", "started_at": "2025-10-23T17:38:44.713314Z", "completed_at": "2025-10-23T17:38:44.726139Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019755840301513672, "adapter_response": {}, "message": "Runtime Error in model stg_sidewalks (models/staging/stg_sidewalks.sql)\n  Binder Error: Catalog \"demo-project\" does not exist!", "failures": null, "unique_id": "model.whylinedenver_dbt.stg_sidewalks", "compiled": true, "compiled_code": "\n\nselect\n    sidewalk_id,\n    class,\n    status,\n    material,\n    year_built,\n    length_m,\n    st_makeline(\n        st_geogpoint(cast(lon_start as float64), cast(lat_start as float64)),\n        st_geogpoint(cast(lon_end as float64), cast(lat_end as float64))\n    ) as geom,\n    st_geogpoint(cast(centroid_lon as float64), cast(centroid_lat as float64)) as centroid\nfrom \"demo-project\".\"raw_denver\".\"raw_sidewalks\"", "relation_name": "\"warehouse\".\"stg_local\".\"stg_sidewalks\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-10-23T17:38:44.732563Z", "completed_at": "2025-10-23T17:38:44.734832Z"}, {"name": "execute", "started_at": "2025-10-23T17:38:44.735054Z", "completed_at": "2025-10-23T17:38:44.746138Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01770305633544922, "adapter_response": {}, "message": "Runtime Error in model stg_weather (models/staging/stg_weather.sql)\n  Binder Error: Catalog \"demo-project\" does not exist!", "failures": null, "unique_id": "model.whylinedenver_dbt.stg_weather", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        date,\n        station,\n        snow_mm,\n        precip_mm,\n        tmin_c,\n        tmax_c,\n        tavg_c,\n        snow_day,\n        precip_bin,\n        _ingested_at\n    from \"demo-project\".\"raw_denver\".\"raw_weather_daily\"\n),\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by date, station\n            order by _ingested_at desc\n        ) as record_rank\n    from base\n)\n\nselect\n    date,\n    station,\n    snow_mm,\n    precip_mm,\n    tmin_c,\n    tmax_c,\n    tavg_c,\n    snow_day,\n    precip_bin\nfrom deduped\nwhere record_rank = 1", "relation_name": "\"warehouse\".\"stg_local\".\"stg_weather\""}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whylinedenver_dbt.mart_crash_proximity_by_stop", "compiled": false, "compiled_code": null, "relation_name": "\"warehouse\".\"mart_local\".\"mart_crash_proximity_by_stop\""}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whylinedenver_dbt.mart_vulnerability_by_stop", "compiled": false, "compiled_code": null, "relation_name": "\"warehouse\".\"mart_local\".\"mart_vulnerability_by_stop\""}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whylinedenver_dbt.stg_rt_events", "compiled": false, "compiled_code": null, "relation_name": "\"warehouse\".\"stg_local\".\"stg_rt_events\""}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whylinedenver_dbt.mart_access_score_by_stop", "compiled": false, "compiled_code": null, "relation_name": "\"warehouse\".\"mart_local\".\"mart_access_score_by_stop\""}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whylinedenver_dbt.mart_reliability_by_route_day", "compiled": false, "compiled_code": null, "relation_name": "\"warehouse\".\"mart_local\".\"mart_reliability_by_route_day\""}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whylinedenver_dbt.mart_reliability_by_stop_hour", "compiled": false, "compiled_code": null, "relation_name": "\"warehouse\".\"mart_local\".\"mart_reliability_by_stop_hour\""}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whylinedenver_dbt.stg_rt_events_daily_stats", "compiled": false, "compiled_code": null, "relation_name": "\"warehouse\".\"stg_local\".\"stg_rt_events_daily_stats\""}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whylinedenver_dbt.mart_weather_impacts", "compiled": false, "compiled_code": null, "relation_name": "\"warehouse\".\"mart_local\".\"mart_weather_impacts\""}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whylinedenver_dbt.mart_priority_hotspots", "compiled": false, "compiled_code": null, "relation_name": "\"warehouse\".\"mart_local\".\"mart_priority_hotspots\""}], "elapsed_time": 0.4246208667755127, "args": {"indirect_selection": "eager", "log_format_file": "debug", "invocation_command": "dbt run --project-dir dbt --no-use-colors --target demo --select staging marts", "warn_error_options": {"include": [], "exclude": []}, "partial_parse_file_diff": true, "select": ["staging", "marts"], "version_check": true, "require_explicit_package_overrides_for_builtin_materializations": true, "empty": false, "target": "demo", "printer_width": 80, "defer": false, "populate_cache": true, "log_file_max_bytes": 10485760, "quiet": false, "send_anonymous_usage_stats": true, "strict_mode": false, "enable_legacy_logger": false, "use_colors": false, "introspect": true, "profiles_dir": "/Users/medsidd/Desktop/whyline-denver/dbt/profiles", "partial_parse": true, "source_freshness_run_project_hooks": false, "project_dir": "dbt", "write_json": true, "static_parser": true, "cache_selected_only": false, "macro_debugging": false, "print": true, "require_resource_names_without_spaces": false, "log_level_file": "debug", "use_colors_file": false, "favor_state": false, "vars": {}, "which": "run", "show_resource_report": false, "log_format": "default", "exclude": [], "log_path": "dbt/logs", "log_level": "info"}}