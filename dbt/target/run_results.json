{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.5", "generated_at": "2025-11-28T00:04:14.021856Z", "invocation_id": "9b453553-62fc-40bb-b22e-9511f8cad20b", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T00:04:10.141159Z", "completed_at": "2025-11-28T00:04:10.158592Z"}, {"name": "execute", "started_at": "2025-11-28T00:04:10.158954Z", "completed_at": "2025-11-28T00:04:14.015095Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.8749940395355225, "adapter_response": {"_message": "MERGE (5.6k rows, 6.3 MiB processed)", "code": "MERGE", "rows_affected": 5647, "bytes_processed": 6600536, "bytes_billed": 31457280, "location": "US", "project_id": "whyline-denver", "job_id": "9c6c430c-4ac2-4a60-a2c2-4624f2cd571e", "slot_ms": 45250}, "message": "MERGE (5.6k rows, 6.3 MiB processed)", "failures": null, "unique_id": "model.whylinedenver_dbt.mart_reliability_by_stop_hour", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        stop_id,\n        route_id,\n        service_date_mst,\n        event_hour_mst,\n        delay_sec\n    from `whyline-denver`.`stg_denver`.`int_rt_events_resolved`\n    where stop_id is not null\n    \n        and service_date_mst >= date_sub(current_date(\"America/Denver\"), interval 3 day)\n    \n),\nhead AS (\n    select\n        stop_id,\n        service_date_mst,\n        extract(hour from event_ts_utc at time zone \"America/Denver\") as event_hour_mst,\n        avg(headway_adherent) as headway_adherence_rate,\n        approx_quantiles(obs_headway_sec, 100)[offset(50)] as obs_headway_sec_p50,\n        approx_quantiles(obs_headway_sec, 100)[offset(90)] as obs_headway_sec_p90\n    from `whyline-denver`.`stg_denver`.`int_headway_adherence`\n    group by\n        stop_id,\n        service_date_mst,\n        event_hour_mst\n),\nagg as (\n    select\n        stop_id,\n        service_date_mst,\n        event_hour_mst,\n        count(*) as n_events,\n        avg(case when abs(delay_sec) <= 300 then 1 else 0 end) as pct_on_time,\n        avg(delay_sec) as mean_delay_sec,\n        approx_quantiles(delay_sec, 100)[offset(90)] as p90_delay_sec\n    from base\n    group by\n        stop_id,\n        service_date_mst,\n        event_hour_mst\n),\nroute_mode as (\n    select\n        stop_id,\n        service_date_mst,\n        event_hour_mst,\n        array_agg(route_id order by route_events desc, route_id limit 1)[offset(0)] as route_id_mode\n    from (\n        select\n            stop_id,\n            service_date_mst,\n            event_hour_mst,\n            route_id,\n            count(*) as route_events\n        from base\n        where route_id is not null\n        group by\n            stop_id,\n            service_date_mst,\n            event_hour_mst,\n            route_id\n    )\n    group by\n        stop_id,\n        service_date_mst,\n        event_hour_mst\n)\n\nselect\n    a.stop_id,\n    a.service_date_mst,\n    a.event_hour_mst,\n    a.n_events,\n    a.pct_on_time,\n    a.mean_delay_sec,\n    a.p90_delay_sec,\n    coalesce(rm.route_id_mode, 'unknown') as route_id_mode,\n    h.headway_adherence_rate,\n    h.obs_headway_sec_p50,\n    h.obs_headway_sec_p90,\n    current_timestamp() as build_run_at\nfrom agg as a\nleft join head as h\n    using (stop_id, service_date_mst, event_hour_mst)\nleft join route_mode as rm\n    using (stop_id, service_date_mst, event_hour_mst)", "relation_name": "`whyline-denver`.`mart_denver`.`mart_reliability_by_stop_hour`"}], "elapsed_time": 4.9733521938323975, "args": {"enable_legacy_logger": false, "profiles_dir": "/Users/medsidd/Desktop/whyline-denver/dbt/profiles", "cache_selected_only": false, "show_resource_report": false, "warn_error_options": {"include": [], "exclude": []}, "exclude": [], "write_json": true, "log_level": "info", "version_check": true, "send_anonymous_usage_stats": true, "log_path": "/Users/medsidd/Desktop/whyline-denver/dbt/logs", "static_parser": true, "quiet": false, "defer": false, "favor_state": false, "use_colors_file": true, "source_freshness_run_project_hooks": false, "populate_cache": true, "target": "prod", "macro_debugging": false, "partial_parse_file_diff": true, "indirect_selection": "eager", "project_dir": "/Users/medsidd/Desktop/whyline-denver/dbt", "require_resource_names_without_spaces": false, "log_level_file": "debug", "invocation_command": "dbt run --select mart_reliability_by_stop_hour", "print": true, "strict_mode": false, "log_format": "default", "select": ["mart_reliability_by_stop_hour"], "vars": {}, "partial_parse": true, "introspect": true, "printer_width": 80, "which": "run", "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors": true, "log_format_file": "debug", "log_file_max_bytes": 10485760, "empty": false}}