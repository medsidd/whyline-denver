{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.5", "generated_at": "2026-02-26T07:02:40.986125Z", "invocation_id": "01e14664-bd29-44a3-ab76-8328a5a6ae79", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.631669Z", "completed_at": "2026-02-26T07:02:40.644268Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.644578Z", "completed_at": "2026-02-26T07:02:40.644610Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013756036758422852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.stg_acs_geo", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        geoid,\n        name,\n        year,\n        hh_no_vehicle,\n        hh_total,\n        workers_transit,\n        workers_total,\n        persons_poverty,\n        pop_total,\n        pct_hh_no_vehicle,\n        pct_transit_commute,\n        pct_poverty,\n        _ingested_at\n    from `whyline-denver`.`raw_denver`.`raw_acs_tract`\n),\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by geoid\n            order by year desc, _ingested_at desc\n        ) as tract_rank\n    from base\n)\n\nselect\n    geoid,\n    name,\n    year,\n    hh_no_vehicle,\n    hh_total,\n    workers_transit,\n    workers_total,\n    persons_poverty,\n    pop_total,\n    pct_hh_no_vehicle,\n    pct_transit_commute,\n    pct_poverty\nfrom deduped\nwhere tract_rank = 1", "relation_name": "`whyline-denver`.`stg_denver`.`stg_acs_geo`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.646221Z", "completed_at": "2026-02-26T07:02:40.649131Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.649403Z", "completed_at": "2026-02-26T07:02:40.649408Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003937721252441406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.stg_denver_crashes", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        crash_id,\n        event_ts_utc,\n        severity,\n        severity_text,\n        lon,\n        lat,\n        roadway_name,\n        on_route,\n        off_route,\n        bike_involved,\n        ped_involved\n    from `whyline-denver`.`raw_denver`.`raw_crashes`\n    where lon is not null\n      and lat is not null\n),\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by crash_id\n            order by event_ts_utc desc, severity desc\n        ) as crash_rank\n    from base\n)\nselect\n    crash_id,\n    event_ts_utc,\n    severity,\n    severity_text,\n    \n    ST_GEOGPOINT(CAST(lon AS FLOAT64), CAST(lat AS FLOAT64))\n as geom,\n    roadway_name,\n    on_route,\n    off_route,\n    bike_involved,\n    ped_involved,\n    \n    DATE(event_ts_utc, \"America/Denver\")\n as event_date_mst,\n    \n    EXTRACT(HOUR FROM DATETIME(event_ts_utc, \"America/Denver\"))\n as event_hour_mst\nfrom deduped\nwhere crash_rank = 1", "relation_name": "`whyline-denver`.`stg_denver`.`stg_denver_crashes`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.650665Z", "completed_at": "2026-02-26T07:02:40.653216Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.653456Z", "completed_at": "2026-02-26T07:02:40.653460Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0033369064331054688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.stg_denver_tracts", "compiled": true, "compiled_code": "\n\n\n    \n\n\nwith ranked as (\n    select\n        geoid,\n        name,\n        aland_m2,\n        awater_m2,\n        geometry_geojson,\n        _ingested_at,\n        row_number() over (\n            partition by geoid\n            order by _ingested_at desc\n        ) as record_rank\n    from `whyline-denver`.`raw_denver`.`raw_denver_tracts`\n)\n\nselect\n    geoid,\n    name,\n    aland_m2,\n    awater_m2,\n    ST_GEOGFROMGEOJSON(geometry_geojson, make_valid => true) as geom\nfrom ranked\nwhere record_rank = 1", "relation_name": "`whyline-denver`.`stg_denver`.`stg_denver_tracts`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.654668Z", "completed_at": "2026-02-26T07:02:40.656799Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.657052Z", "completed_at": "2026-02-26T07:02:40.657056Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002928018569946289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.stg_gtfs_routes", "compiled": true, "compiled_code": "\n\nwith deduped as (\n    select\n        route_id,\n        coalesce(nullif(route_short_name, ''), route_long_name) as route_name,\n        route_long_name,\n        route_type,\n        route_desc,\n        TRUE as is_active,\n        row_number() over (\n            partition by route_id\n            order by route_long_name, route_desc, route_short_name\n        ) as route_rank\n    from `whyline-denver`.`raw_denver`.`raw_gtfs_routes`\n)\n\nselect\n    route_id,\n    route_name,\n    route_long_name,\n    route_type,\n    route_desc,\n    is_active\nfrom deduped\nwhere route_rank = 1", "relation_name": "`whyline-denver`.`stg_denver`.`stg_gtfs_routes`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.658247Z", "completed_at": "2026-02-26T07:02:40.660282Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.660486Z", "completed_at": "2026-02-26T07:02:40.660490Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002767801284790039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.stg_gtfs_stop_times", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        trip_id,\n        stop_id,\n        stop_sequence,\n        arrival_time,\n        departure_time\n    from `whyline-denver`.`raw_denver`.`raw_gtfs_stop_times`\n    where _extract_date = (\n        select max(_extract_date) from `whyline-denver`.`raw_denver`.`raw_gtfs_stop_times`\n    )\n),\nnorm as (\n    select\n        *,\n        split(arrival_time, ':')[offset(0)] as a_h,\n        split(arrival_time, ':')[offset(1)] as a_m,\n        split(arrival_time, ':')[offset(2)] as a_s,\n        split(departure_time, ':')[offset(0)] as d_h,\n        split(departure_time, ':')[offset(1)] as d_m,\n        split(departure_time, ':')[offset(2)] as d_s\n    from base\n)\nselect\n    trip_id,\n    stop_id,\n    stop_sequence,\n    arrival_time,\n    departure_time,\n    cast(a_h as int64) as arr_hour_gtfs,\n    cast(d_h as int64) as dep_hour_gtfs,\n    case\n        when cast(a_h as int64) is null then null\n        else cast(a_h as int64)\n    end as arr_hour_bucket\nfrom norm\nqualify row_number() over (partition by trip_id, stop_id, stop_sequence order by arrival_time) = 1", "relation_name": "`whyline-denver`.`stg_denver`.`stg_gtfs_stop_times`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.661517Z", "completed_at": "2026-02-26T07:02:40.663564Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.663785Z", "completed_at": "2026-02-26T07:02:40.663789Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0027358531951904297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.stg_gtfs_stops", "compiled": true, "compiled_code": "\n\nwith ranked_stops as (\n    select\n        stop_id,\n        stop_name,\n        stop_lat,\n        stop_lon,\n        \n    ST_GEOGPOINT(CAST(stop_lon AS FLOAT64), CAST(stop_lat AS FLOAT64))\n as geom,\n        \n    SAFE_CAST(wheelchair_boarding AS INT64)\n as wheelchair_boarding,\n        row_number() over (\n            partition by stop_id\n            order by stop_name, stop_lat, stop_lon\n        ) as stop_rank\n    from `whyline-denver`.`raw_denver`.`raw_gtfs_stops`\n)\n\nselect\n    stop_id,\n    stop_name,\n    stop_lat,\n    stop_lon,\n    geom,\n    wheelchair_boarding\nfrom ranked_stops\nwhere stop_rank = 1", "relation_name": "`whyline-denver`.`stg_denver`.`stg_gtfs_stops`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.666128Z", "completed_at": "2026-02-26T07:02:40.668551Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.668765Z", "completed_at": "2026-02-26T07:02:40.668769Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004391908645629883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.stg_gtfs_trips", "compiled": true, "compiled_code": "\n\nwith cal as (\n    select\n        service_id,\n        start_date,\n        end_date,\n        monday,\n        tuesday,\n        wednesday,\n        thursday,\n        friday,\n        saturday,\n        sunday\n    from `whyline-denver`.`raw_denver`.`raw_gtfs_calendar`\n    where _extract_date = (\n        select max(_extract_date) from `whyline-denver`.`raw_denver`.`raw_gtfs_calendar`\n    )\n),\nex as (\n    select\n        service_id,\n        array_agg(case when exception_type = 1 then date end ignore nulls) as added_service_dates,\n        array_agg(case when exception_type = 2 then date end ignore nulls) as removed_service_dates\n    from `whyline-denver`.`raw_denver`.`raw_gtfs_calendar_dates`\n    where _extract_date = (\n        select max(_extract_date) from `whyline-denver`.`raw_denver`.`raw_gtfs_calendar_dates`\n    )\n    group by service_id\n),\ntr as (\n    select\n        trip_id,\n        route_id,\n        service_id,\n        direction_id,\n        shape_id,\n        trip_headsign\n    from `whyline-denver`.`raw_denver`.`raw_gtfs_trips`\n    where _extract_date = (\n        select max(_extract_date) from `whyline-denver`.`raw_denver`.`raw_gtfs_trips`\n    )\n)\nselect\n    tr.trip_id,\n    tr.route_id,\n    tr.service_id,\n    tr.direction_id,\n    tr.shape_id,\n    tr.trip_headsign,\n    cal.start_date,\n    cal.end_date,\n    cal.monday,\n    cal.tuesday,\n    cal.wednesday,\n    cal.thursday,\n    cal.friday,\n    cal.saturday,\n    cal.sunday,\n    ex.added_service_dates,\n    ex.removed_service_dates\nfrom tr\nleft join cal using (service_id)\nleft join ex using (service_id)\nqualify row_number() over (partition by tr.trip_id order by tr.service_id) = 1", "relation_name": "`whyline-denver`.`stg_denver`.`stg_gtfs_trips`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.670021Z", "completed_at": "2026-02-26T07:02:40.671754Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.671969Z", "completed_at": "2026-02-26T07:02:40.671973Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026051998138427734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.stg_sidewalks", "compiled": true, "compiled_code": "\n\nselect\n    sidewalk_id,\n    class,\n    status,\n    material,\n    year_built,\n    length_m,\n    st_makeline(\n        st_geogpoint(cast(lon_start as float64), cast(lat_start as float64)),\n        st_geogpoint(cast(lon_end as float64), cast(lat_end as float64))\n    ) as geom,\n    st_geogpoint(cast(centroid_lon as float64), cast(centroid_lat as float64)) as centroid\nfrom `whyline-denver`.`raw_denver`.`raw_sidewalks`", "relation_name": "`whyline-denver`.`stg_denver`.`stg_sidewalks`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.673250Z", "completed_at": "2026-02-26T07:02:40.674820Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.675029Z", "completed_at": "2026-02-26T07:02:40.675032Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0024781227111816406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.stg_weather", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        date,\n        station,\n        snow_mm,\n        precip_mm,\n        tmin_c,\n        tmax_c,\n        tavg_c,\n        snow_day,\n        precip_bin,\n        _ingested_at\n    from `whyline-denver`.`raw_denver`.`raw_weather_daily`\n),\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by date, station\n            order by _ingested_at desc\n        ) as record_rank\n    from base\n)\n\nselect\n    date,\n    station,\n    snow_mm,\n    precip_mm,\n    tmin_c,\n    tmax_c,\n    tavg_c,\n    snow_day,\n    precip_bin\nfrom deduped\nwhere record_rank = 1", "relation_name": "`whyline-denver`.`stg_denver`.`stg_weather`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.676151Z", "completed_at": "2026-02-26T07:02:40.678398Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.678859Z", "completed_at": "2026-02-26T07:02:40.678862Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003336191177368164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.accepted_range_stg_acs_geo_pct_hh_no_vehicle__1__0.bb26d27cf8", "compiled": true, "compiled_code": "\n    select\n        pct_hh_no_vehicle as value\n    from `whyline-denver`.`stg_denver`.`stg_acs_geo`\n    where 1 = 1\n        and pct_hh_no_vehicle < 0\n        and pct_hh_no_vehicle > 1\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.680229Z", "completed_at": "2026-02-26T07:02:40.682472Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.682687Z", "completed_at": "2026-02-26T07:02:40.682690Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003228902816772461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.accepted_range_stg_acs_geo_pct_poverty__1__0.c2276b8664", "compiled": true, "compiled_code": "\n    select\n        pct_poverty as value\n    from `whyline-denver`.`stg_denver`.`stg_acs_geo`\n    where 1 = 1\n        and pct_poverty < 0\n        and pct_poverty > 1\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.683626Z", "completed_at": "2026-02-26T07:02:40.685834Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.686138Z", "completed_at": "2026-02-26T07:02:40.686143Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002979278564453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.accepted_range_stg_acs_geo_pct_transit_commute__1__0.54a46fa8b6", "compiled": true, "compiled_code": "\n    select\n        pct_transit_commute as value\n    from `whyline-denver`.`stg_denver`.`stg_acs_geo`\n    where 1 = 1\n        and pct_transit_commute < 0\n        and pct_transit_commute > 1\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.687323Z", "completed_at": "2026-02-26T07:02:40.691810Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.692026Z", "completed_at": "2026-02-26T07:02:40.692029Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005266904830932617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_acs_geo_geoid.e06639a503", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect geoid\nfrom `whyline-denver`.`stg_denver`.`stg_acs_geo`\nwhere geoid is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.693245Z", "completed_at": "2026-02-26T07:02:40.696713Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.696951Z", "completed_at": "2026-02-26T07:02:40.696955Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0043239593505859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.unique_stg_acs_geo_geoid.15e2f3f645", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select geoid as unique_field\n  from `whyline-denver`.`stg_denver`.`stg_acs_geo`\n  where geoid is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.698140Z", "completed_at": "2026-02-26T07:02:40.700758Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.701162Z", "completed_at": "2026-02-26T07:02:40.701166Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003628969192504883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_denver_crashes_crash_id.2d4abfa048", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect crash_id\nfrom `whyline-denver`.`stg_denver`.`stg_denver_crashes`\nwhere crash_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.702497Z", "completed_at": "2026-02-26T07:02:40.704720Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.704931Z", "completed_at": "2026-02-26T07:02:40.704935Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0031011104583740234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_denver_crashes_event_ts_utc.f0325f0894", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_ts_utc\nfrom `whyline-denver`.`stg_denver`.`stg_denver_crashes`\nwhere event_ts_utc is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.706222Z", "completed_at": "2026-02-26T07:02:40.708732Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.708966Z", "completed_at": "2026-02-26T07:02:40.708970Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0034589767456054688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_denver_crashes_geom.46d75afae2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect geom\nfrom `whyline-denver`.`stg_denver`.`stg_denver_crashes`\nwhere geom is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.710179Z", "completed_at": "2026-02-26T07:02:40.713278Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.713478Z", "completed_at": "2026-02-26T07:02:40.713481Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003859996795654297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.unique_stg_denver_crashes_crash_id.3a8a6a41c9", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select crash_id as unique_field\n  from `whyline-denver`.`stg_denver`.`stg_denver_crashes`\n  where crash_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.714647Z", "completed_at": "2026-02-26T07:02:40.717389Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.717639Z", "completed_at": "2026-02-26T07:02:40.717642Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036160945892333984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_denver_tracts_aland_m2.d22cd1914e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect aland_m2\nfrom `whyline-denver`.`stg_denver`.`stg_denver_tracts`\nwhere aland_m2 is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.720457Z", "completed_at": "2026-02-26T07:02:40.723260Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.723543Z", "completed_at": "2026-02-26T07:02:40.723547Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005261659622192383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_denver_tracts_geoid.12a4276960", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect geoid\nfrom `whyline-denver`.`stg_denver`.`stg_denver_tracts`\nwhere geoid is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.724645Z", "completed_at": "2026-02-26T07:02:40.727047Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.727258Z", "completed_at": "2026-02-26T07:02:40.727261Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0031261444091796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_denver_tracts_geom.45f12da7f2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect geom\nfrom `whyline-denver`.`stg_denver`.`stg_denver_tracts`\nwhere geom is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.728359Z", "completed_at": "2026-02-26T07:02:40.730689Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.730893Z", "completed_at": "2026-02-26T07:02:40.730897Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0031049251556396484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_denver_tracts_name.73c03e7de3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect name\nfrom `whyline-denver`.`stg_denver`.`stg_denver_tracts`\nwhere name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.731826Z", "completed_at": "2026-02-26T07:02:40.733673Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.733857Z", "completed_at": "2026-02-26T07:02:40.733860Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002445220947265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.unique_stg_denver_tracts_geoid.41744673c0", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select geoid as unique_field\n  from `whyline-denver`.`stg_denver`.`stg_denver_tracts`\n  where geoid is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.734736Z", "completed_at": "2026-02-26T07:02:40.736646Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.736840Z", "completed_at": "2026-02-26T07:02:40.736845Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0025217533111572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_gtfs_routes_route_id.90a121a58c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect route_id\nfrom `whyline-denver`.`stg_denver`.`stg_gtfs_routes`\nwhere route_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.737714Z", "completed_at": "2026-02-26T07:02:40.739582Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.739771Z", "completed_at": "2026-02-26T07:02:40.739774Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002471923828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.unique_combination_stg_gtfs_routes_route_id.9084187a60", "compiled": true, "compiled_code": "\n    select\n        route_id\n    from `whyline-denver`.`stg_denver`.`stg_gtfs_routes`\n    group by route_id\n    having count(*) > 1\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.740672Z", "completed_at": "2026-02-26T07:02:40.742533Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.742723Z", "completed_at": "2026-02-26T07:02:40.742725Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002459287643432617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_gtfs_stop_times_stop_id.2ed25f210c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stop_id\nfrom `whyline-denver`.`stg_denver`.`stg_gtfs_stop_times`\nwhere stop_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.743585Z", "completed_at": "2026-02-26T07:02:40.745423Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.745609Z", "completed_at": "2026-02-26T07:02:40.745611Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0024330615997314453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_gtfs_stop_times_trip_id.aff3052922", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect trip_id\nfrom `whyline-denver`.`stg_denver`.`stg_gtfs_stop_times`\nwhere trip_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.746520Z", "completed_at": "2026-02-26T07:02:40.748563Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.748756Z", "completed_at": "2026-02-26T07:02:40.748759Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002655029296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.mart_crash_proximity_by_stop", "compiled": true, "compiled_code": "\n\nwith params as (\n    select\n        max(date(event_ts_utc)) as as_of_date,\n        365 as window_days\n    from `whyline-denver`.`stg_denver`.`stg_denver_crashes`\n),\nst as (\n    select\n        stop_id,\n        geom\n    from `whyline-denver`.`stg_denver`.`stg_gtfs_stops`\n),\ncr as (\n    select\n        event_ts_utc,\n        geom,\n        severity\n    from `whyline-denver`.`stg_denver`.`stg_denver_crashes`\n    cross join params\n    where date(event_ts_utc) between date_sub(params.as_of_date, interval params.window_days day) and params.as_of_date\n),\nstop_crash as (\n    select\n        s.stop_id,\n        params.as_of_date,\n        params.window_days,\n        cr.severity,\n        st_distance(s.geom, cr.geom) as distance_m\n    from params\n    cross join st as s\n    join cr\n        on st_dwithin(s.geom, cr.geom, 250)\n),\nagg as (\n    select\n        stop_id,\n        as_of_date,\n        window_days,\n        countif(distance_m <= 100) as crash_100m_cnt,\n        countif(distance_m <= 100 and severity >= 3) as severe_100m_cnt,\n        countif(distance_m <= 100 and severity = 4) as fatal_100m_cnt,\n        count(*) as crash_250m_cnt,\n        countif(severity >= 3) as severe_250m_cnt,\n        countif(severity = 4) as fatal_250m_cnt\n    from stop_crash\n    group by\n        stop_id,\n        as_of_date,\n        window_days\n)\n\nselect\n    s.stop_id,\n    params.as_of_date as as_of_date,\n    params.window_days as window_days,\n    coalesce(a.crash_100m_cnt, 0) as crash_100m_cnt,\n    coalesce(a.severe_100m_cnt, 0) as severe_100m_cnt,\n    coalesce(a.fatal_100m_cnt, 0) as fatal_100m_cnt,\n    coalesce(a.crash_250m_cnt, 0) as crash_250m_cnt,\n    coalesce(a.severe_250m_cnt, 0) as severe_250m_cnt,\n    coalesce(a.fatal_250m_cnt, 0) as fatal_250m_cnt,\n    current_timestamp() as build_run_at\nfrom st as s\ncross join params\nleft join agg as a\n    on s.stop_id = a.stop_id\n    and params.as_of_date = a.as_of_date\n    and params.window_days = a.window_days", "relation_name": "`whyline-denver`.`mart_denver`.`mart_crash_proximity_by_stop`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.749748Z", "completed_at": "2026-02-26T07:02:40.752404Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.752587Z", "completed_at": "2026-02-26T07:02:40.752589Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003326892852783203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.mart_gtfs_stops", "compiled": true, "compiled_code": "\n\nSELECT\n    stop_id,\n    stop_name\nFROM `whyline-denver`.`stg_denver`.`stg_gtfs_stops`", "relation_name": "`whyline-denver`.`mart_denver`.`mart_gtfs_stops`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.753496Z", "completed_at": "2026-02-26T07:02:40.755391Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.755581Z", "completed_at": "2026-02-26T07:02:40.755583Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0024938583374023438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.mart_vulnerability_by_stop", "compiled": true, "compiled_code": "\n\nwith stops as (\n    select\n        stop_id,\n        geom\n    from `whyline-denver`.`stg_denver`.`stg_gtfs_stops`\n),\ntracts as (\n    select\n        geoid,\n        geom\n    from `whyline-denver`.`stg_denver`.`stg_denver_tracts`\n),\nacs as (\n    select\n        regexp_replace(geoid, '^14000US', '') as geoid,\n        pop_total,\n        pct_hh_no_vehicle,\n        pct_transit_commute,\n        pct_poverty\n    from `whyline-denver`.`stg_denver`.`stg_acs_geo`\n    where pop_total > 0\n),\nnear as (\n    select\n        s.stop_id,\n        t.geoid\n    from stops as s\n    join tracts as t\n        -- 804.672 meters is approximately 0.5 miles, a standard walkable catchment distance in transit equity analysis.\n        -- This distance is used to associate each stop with nearby census tracts for vulnerability analysis, reflecting typical access/walkshed studies.\n        on st_dwithin(s.geom, t.geom, 804.672)\n),\nw as (\n    select\n        n.stop_id,\n        a.geoid,\n        a.pop_total,\n        a.pct_hh_no_vehicle,\n        a.pct_transit_commute,\n        a.pct_poverty\n    from near as n\n    join acs as a\n        using (geoid)\n),\nnorm as (\n    select\n        stop_id,\n        sum(pop_total) as pop_sum,\n        sum(pct_hh_no_vehicle * pop_total) / nullif(sum(pop_total), 0) as pct_hh_no_vehicle_w,\n        sum(pct_transit_commute * pop_total) / nullif(sum(pop_total), 0) as pct_transit_commute_w,\n        sum(pct_poverty * pop_total) / nullif(sum(pop_total), 0) as pct_poverty_w\n    from w\n    group by\n        stop_id\n),\nscore as (\n    select\n        *,\n        (pct_hh_no_vehicle_w + pct_transit_commute_w + pct_poverty_w) / 3.0 as vuln_raw\n    from norm\n),\njoined as (\n    select\n        s.stop_id,\n        n.pct_hh_no_vehicle_w,\n        n.pct_transit_commute_w,\n        n.pct_poverty_w,\n        n.vuln_raw\n    from stops as s\n    left join score as n\n        using (stop_id)\n)\n\nselect\n    stop_id,\n    pct_hh_no_vehicle_w,\n    pct_transit_commute_w,\n    pct_poverty_w,\n    cast(\n        round(\n            case\n                when max(vuln_raw) over () = min(vuln_raw) over () then 100\n                else (\n                    (vuln_raw - min(vuln_raw) over ()) /\n                    nullif(\n                        max(vuln_raw) over () - min(vuln_raw) over (),\n                        0\n                    ) * 100\n                )\n            end,\n            1\n        ) as float64\n    ) as vuln_score_0_100,\n    current_timestamp() as build_run_at\nfrom joined", "relation_name": "`whyline-denver`.`mart_denver`.`mart_vulnerability_by_stop`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.756510Z", "completed_at": "2026-02-26T07:02:40.758431Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.758618Z", "completed_at": "2026-02-26T07:02:40.758620Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002530813217163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_gtfs_stops_geom.0cd728f20a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect geom\nfrom `whyline-denver`.`stg_denver`.`stg_gtfs_stops`\nwhere geom is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.759708Z", "completed_at": "2026-02-26T07:02:40.761672Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.761866Z", "completed_at": "2026-02-26T07:02:40.761868Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0027420520782470703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_gtfs_stops_stop_id.c41a0f2d33", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stop_id\nfrom `whyline-denver`.`stg_denver`.`stg_gtfs_stops`\nwhere stop_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.762739Z", "completed_at": "2026-02-26T07:02:40.764530Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.764716Z", "completed_at": "2026-02-26T07:02:40.764719Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023801326751708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.unique_stg_gtfs_stops_stop_id.583c0cfb05", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select stop_id as unique_field\n  from `whyline-denver`.`stg_denver`.`stg_gtfs_stops`\n  where stop_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.765583Z", "completed_at": "2026-02-26T07:02:40.769129Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.769326Z", "completed_at": "2026-02-26T07:02:40.769328Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00414729118347168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.int_scheduled_arrivals", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\nwith calendar as (\n    select\n        service_id,\n        safe.parse_date('%Y%m%d', start_date) as start_date,\n        safe.parse_date('%Y%m%d', end_date) as end_date,\n        monday = 1 as runs_monday,\n        tuesday = 1 as runs_tuesday,\n        wednesday = 1 as runs_wednesday,\n        thursday = 1 as runs_thursday,\n        friday = 1 as runs_friday,\n        saturday = 1 as runs_saturday,\n        sunday = 1 as runs_sunday\n    from `whyline-denver`.`raw_denver`.`raw_gtfs_calendar`\n    where start_date is not null and start_date != ''\n      and end_date is not null and end_date != ''\n      and safe.parse_date('%Y%m%d', start_date) is not null\n      and safe.parse_date('%Y%m%d', end_date) is not null\n      and _extract_date = (\n          select max(_extract_date) from `whyline-denver`.`raw_denver`.`raw_gtfs_calendar`\n      )\n),\ncalendar_dates as (\n    select\n        service_id,\n        safe.parse_date('%Y%m%d', date) as exception_date,\n        exception_type\n    from `whyline-denver`.`raw_denver`.`raw_gtfs_calendar_dates`\n    where date is not null and date != ''\n      and safe.parse_date('%Y%m%d', date) is not null\n      and _extract_date = (\n          select max(_extract_date) from `whyline-denver`.`raw_denver`.`raw_gtfs_calendar_dates`\n      )\n),\ndate_spine as (\n    -- Generate all dates in the expansion window\n    \n\nwith date_array as (\n    select\n        generate_date_array(\n            date_sub(current_date('America/Denver'), interval 45 day),\n            date_add(current_date('America/Denver'), interval 30 day),\n            interval 1 day\n        ) as dates\n),\nunnested as (\n    select date_value\n    from date_array\n    cross join unnest(dates) as date_value\n)\nselect\n    date_value as service_date,\n    case extract(dayofweek from date_value)\n        when 1 then 'sunday'\n        when 2 then 'monday'\n        when 3 then 'tuesday'\n        when 4 then 'wednesday'\n        when 5 then 'thursday'\n        when 6 then 'friday'\n        when 7 then 'saturday'\n    end as day_of_week,\n    extract(dayofweek from date_value) = 1 as is_sunday,\n    extract(dayofweek from date_value) = 2 as is_monday,\n    extract(dayofweek from date_value) = 3 as is_tuesday,\n    extract(dayofweek from date_value) = 4 as is_wednesday,\n    extract(dayofweek from date_value) = 5 as is_thursday,\n    extract(dayofweek from date_value) = 6 as is_friday,\n    extract(dayofweek from date_value) = 7 as is_saturday\nfrom unnested\n\n),\nservice_dates as (\n    -- Cross-join calendar with date spine, filter by service period and day of week\n    select\n        cal.service_id,\n        ds.service_date\n    from calendar as cal\n    cross join date_spine as ds\n    where ds.service_date >= cal.start_date\n      and ds.service_date <= cal.end_date\n      and (\n        -- Filter by day of week based on calendar\n        (ds.is_monday and cal.runs_monday)\n        or (ds.is_tuesday and cal.runs_tuesday)\n        or (ds.is_wednesday and cal.runs_wednesday)\n        or (ds.is_thursday and cal.runs_thursday)\n        or (ds.is_friday and cal.runs_friday)\n        or (ds.is_saturday and cal.runs_saturday)\n        or (ds.is_sunday and cal.runs_sunday)\n      )\n),\nservice_dates_with_exceptions as (\n    select\n        sd.service_id,\n        sd.service_date\n    from service_dates as sd\n    left join calendar_dates as cd_remove\n        on sd.service_id = cd_remove.service_id\n        and sd.service_date = cd_remove.exception_date\n        and cd_remove.exception_type = 2  -- Removed service\n    where cd_remove.exception_date is null  -- Exclude removed dates\n\n    union distinct\n\n    -- Add exception dates (exception_type = 1)\n    select\n        service_id,\n        exception_date as service_date\n    from calendar_dates\n    where exception_type = 1\n      and exception_date >= date_sub(current_date('America/Denver'), interval 45 day)\n      and exception_date <= date_add(current_date('America/Denver'), interval 30 day)\n),\ntrips_expanded as (\n    -- Expand trips to all their service dates\n    select\n        tr.trip_id,\n        tr.route_id,\n        tr.direction_id,\n        sd.service_date\n    from `whyline-denver`.`stg_denver`.`stg_gtfs_trips` as tr\n    join service_dates_with_exceptions as sd\n        on tr.service_id = sd.service_id\n),\nstop_times as (\n    select\n        trip_id,\n        stop_id,\n        stop_sequence,\n        nullif(arrival_time, '') as arrival_time,\n        nullif(departure_time, '') as departure_time\n    from `whyline-denver`.`stg_denver`.`stg_gtfs_stop_times`\n),\njoined as (\n    select\n        te.trip_id,\n        st.stop_id,\n        st.stop_sequence,\n        te.route_id,\n        te.direction_id,\n        te.service_date,\n        case\n            when st.arrival_time is not null then\n                \ntimestamp(\n    datetime(\n        date_add(\n            te.service_date,\n            interval cast(floor(\n                safe_cast(split(st.arrival_time, ':')[offset(0)] as int64) / 24\n            ) as int64) day\n        ),\n        time(\n            mod(\n                safe_cast(split(st.arrival_time, ':')[offset(0)] as int64),\n                24\n            ),\n            safe_cast(split(st.arrival_time, ':')[offset(1)] as int64),\n            safe_cast(split(st.arrival_time, ':')[offset(2)] as int64)\n        )\n    ),\n    \"America/Denver\"\n)\n\n        end as sched_arrival_ts_mst,\n        case\n            when st.departure_time is not null then\n                \ntimestamp(\n    datetime(\n        date_add(\n            te.service_date,\n            interval cast(floor(\n                safe_cast(split(st.departure_time, ':')[offset(0)] as int64) / 24\n            ) as int64) day\n        ),\n        time(\n            mod(\n                safe_cast(split(st.departure_time, ':')[offset(0)] as int64),\n                24\n            ),\n            safe_cast(split(st.departure_time, ':')[offset(1)] as int64),\n            safe_cast(split(st.departure_time, ':')[offset(2)] as int64)\n        )\n    ),\n    \"America/Denver\"\n)\n\n        end as sched_departure_ts_mst\n    from trips_expanded as te\n    join stop_times as st\n        on te.trip_id = st.trip_id\n)\n\nselect\n    trip_id,\n    stop_id,\n    stop_sequence,\n    route_id,\n    direction_id,\n    sched_arrival_ts_mst,\n    sched_departure_ts_mst,\n    service_date as service_date_mst\nfrom joined\nwhere sched_arrival_ts_mst is not null or sched_departure_ts_mst is not null", "relation_name": "`whyline-denver`.`stg_denver`.`int_scheduled_arrivals`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.770254Z", "completed_at": "2026-02-26T07:02:40.772084Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.772276Z", "completed_at": "2026-02-26T07:02:40.772279Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0024330615997314453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_gtfs_trips_trip_id.8fdc26c92c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect trip_id\nfrom `whyline-denver`.`stg_denver`.`stg_gtfs_trips`\nwhere trip_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.773198Z", "completed_at": "2026-02-26T07:02:40.775512Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.775704Z", "completed_at": "2026-02-26T07:02:40.775706Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0029418468475341797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.relationships_stg_gtfs_trips_route_id__route_id__ref_stg_gtfs_routes_.6ddfbb4248", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select route_id as from_field\n    from `whyline-denver`.`stg_denver`.`stg_gtfs_trips`\n    where route_id is not null\n),\n\nparent as (\n    select route_id as to_field\n    from `whyline-denver`.`stg_denver`.`stg_gtfs_routes`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.776586Z", "completed_at": "2026-02-26T07:02:40.778303Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.778488Z", "completed_at": "2026-02-26T07:02:40.778490Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002315998077392578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.mart_access_score_by_stop", "compiled": true, "compiled_code": "\n\nwith buffers as (\n    select\n        stop_id,\n        st_buffer(geom, 200) as buf\n    from `whyline-denver`.`stg_denver`.`stg_gtfs_stops`\n),\nsidewalk_len as (\n    select\n        b.stop_id,\n        sum(st_length(st_intersection(sw.geom, b.buf))) as tot_len_m\n    from buffers as b\n    join `whyline-denver`.`stg_denver`.`stg_sidewalks` as sw\n        on st_intersects(sw.geom, b.buf)\n    group by\n        b.stop_id\n),\nstops as (\n    select\n        b.stop_id,\n        200 as buffer_m,\n        coalesce(s.tot_len_m, 0) as sidewalk_len_m_within_200m\n    from buffers as b\n    left join sidewalk_len as s\n        using (stop_id)\n)\n\nselect\n    stop_id,\n    buffer_m,\n    sidewalk_len_m_within_200m,\n    cast(\n        round(\n            case\n                when max(sidewalk_len_m_within_200m) over () = min(sidewalk_len_m_within_200m) over ()\n                    then 100\n                else (\n                    (sidewalk_len_m_within_200m - min(sidewalk_len_m_within_200m) over ()) /\n                    nullif(\n                        max(sidewalk_len_m_within_200m) over () - min(sidewalk_len_m_within_200m) over (),\n                        0\n                    ) * 100\n                )\n            end,\n            1\n        ) as float64\n    ) as access_score_0_100,\n    current_timestamp() as build_run_at\nfrom stops", "relation_name": "`whyline-denver`.`mart_denver`.`mart_access_score_by_stop`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.779415Z", "completed_at": "2026-02-26T07:02:40.781180Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.781373Z", "completed_at": "2026-02-26T07:02:40.781375Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023779869079589844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.accepted_range_stg_sidewalks_length_m__True__0.64eabe607d", "compiled": true, "compiled_code": "\n    select\n        length_m as value\n    from `whyline-denver`.`stg_denver`.`stg_sidewalks`\n    where 1 = 1\n        and length_m <= 0\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.782231Z", "completed_at": "2026-02-26T07:02:40.783999Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.784182Z", "completed_at": "2026-02-26T07:02:40.784184Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023450851440429688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_sidewalks_geom.4b37ed0d6c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect geom\nfrom `whyline-denver`.`stg_denver`.`stg_sidewalks`\nwhere geom is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.785045Z", "completed_at": "2026-02-26T07:02:40.788798Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.789021Z", "completed_at": "2026-02-26T07:02:40.789024Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00441288948059082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_sidewalks_sidewalk_id.a2404992b6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sidewalk_id\nfrom `whyline-denver`.`stg_denver`.`stg_sidewalks`\nwhere sidewalk_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.790065Z", "completed_at": "2026-02-26T07:02:40.792128Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.792309Z", "completed_at": "2026-02-26T07:02:40.792312Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0027298927307128906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.int_weather_by_date", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        date,\n        station,\n        snow_day,\n        precip_bin,\n        precip_mm\n    from `whyline-denver`.`stg_denver`.`stg_weather`\n    \n        where station = 'USW00023062'\n    \n),\naggregated as (\n    select\n        date as service_date_mst,\n        max(coalesce(snow_day, 0)) as snow_day_flag,\n        array_agg(\n            precip_bin\n            ignore nulls\n            order by precip_mm desc\n        )[offset(0)] as precip_bin\n    from base\n    group by service_date_mst\n)\n\nselect\n    service_date_mst,\n    snow_day_flag > 0 as snow_day,\n    precip_bin\nfrom aggregated", "relation_name": "`whyline-denver`.`stg_denver`.`int_weather_by_date`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.793645Z", "completed_at": "2026-02-26T07:02:40.796148Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.796365Z", "completed_at": "2026-02-26T07:02:40.796368Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003326892852783203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_weather_date.2c564dee75", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date\nfrom `whyline-denver`.`stg_denver`.`stg_weather`\nwhere date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.797382Z", "completed_at": "2026-02-26T07:02:40.799350Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.799539Z", "completed_at": "2026-02-26T07:02:40.799542Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026199817657470703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_weather_station.e234422657", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect station\nfrom `whyline-denver`.`stg_denver`.`stg_weather`\nwhere station is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.800772Z", "completed_at": "2026-02-26T07:02:40.802700Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.802901Z", "completed_at": "2026-02-26T07:02:40.802903Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002777099609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.unique_combination_stg_weather_date__station.06c87a9009", "compiled": true, "compiled_code": "\n    select\n        date, station\n    from `whyline-denver`.`stg_denver`.`stg_weather`\n    group by date, station\n    having count(*) > 1\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.804045Z", "completed_at": "2026-02-26T07:02:40.806549Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.806779Z", "completed_at": "2026-02-26T07:02:40.806783Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003439188003540039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.accepted_range_mart_crash_proximity_by_stop_crash_100m_cnt__0.df522297e2", "compiled": true, "compiled_code": "\n    select\n        crash_100m_cnt as value\n    from `whyline-denver`.`mart_denver`.`mart_crash_proximity_by_stop`\n    where 1 = 1\n        and crash_100m_cnt < 0\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.807897Z", "completed_at": "2026-02-26T07:02:40.809853Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.810047Z", "completed_at": "2026-02-26T07:02:40.810050Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026428699493408203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.accepted_range_mart_crash_proximity_by_stop_crash_250m_cnt__0.d6dc980d04", "compiled": true, "compiled_code": "\n    select\n        crash_250m_cnt as value\n    from `whyline-denver`.`mart_denver`.`mart_crash_proximity_by_stop`\n    where 1 = 1\n        and crash_250m_cnt < 0\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.811177Z", "completed_at": "2026-02-26T07:02:40.813519Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.813722Z", "completed_at": "2026-02-26T07:02:40.813726Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003145933151245117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_mart_crash_proximity_by_stop_stop_id.1cacc1f770", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stop_id\nfrom `whyline-denver`.`mart_denver`.`mart_crash_proximity_by_stop`\nwhere stop_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.814671Z", "completed_at": "2026-02-26T07:02:40.817121Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.817323Z", "completed_at": "2026-02-26T07:02:40.817328Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0030891895294189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.relationships_mart_crash_proximity_by_stop_stop_id__stop_id__ref_stg_gtfs_stops_.de23f2bf57", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select stop_id as from_field\n    from `whyline-denver`.`mart_denver`.`mart_crash_proximity_by_stop`\n    where stop_id is not null\n),\n\nparent as (\n    select stop_id as to_field\n    from `whyline-denver`.`stg_denver`.`stg_gtfs_stops`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.818237Z", "completed_at": "2026-02-26T07:02:40.820051Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.820247Z", "completed_at": "2026-02-26T07:02:40.820250Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0024399757385253906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.unique_mart_crash_proximity_by_stop_stop_id.2ca1c54c3d", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select stop_id as unique_field\n  from `whyline-denver`.`mart_denver`.`mart_crash_proximity_by_stop`\n  where stop_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.821120Z", "completed_at": "2026-02-26T07:02:40.823013Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.823207Z", "completed_at": "2026-02-26T07:02:40.823209Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0024938583374023438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_mart_gtfs_stops_stop_id.f576a101fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stop_id\nfrom `whyline-denver`.`mart_denver`.`mart_gtfs_stops`\nwhere stop_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.824073Z", "completed_at": "2026-02-26T07:02:40.827144Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.827332Z", "completed_at": "2026-02-26T07:02:40.827335Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036649703979492188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_mart_gtfs_stops_stop_name.4084a232e6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stop_name\nfrom `whyline-denver`.`mart_denver`.`mart_gtfs_stops`\nwhere stop_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.828203Z", "completed_at": "2026-02-26T07:02:40.829951Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.830135Z", "completed_at": "2026-02-26T07:02:40.830137Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023338794708251953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.unique_mart_gtfs_stops_stop_id.4aeecedc2c", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select stop_id as unique_field\n  from `whyline-denver`.`mart_denver`.`mart_gtfs_stops`\n  where stop_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.830994Z", "completed_at": "2026-02-26T07:02:40.832879Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.833071Z", "completed_at": "2026-02-26T07:02:40.833073Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002482175827026367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.accepted_range_mart_vulnerability_by_stop_pct_hh_no_vehicle_w__1__0.37a410496f", "compiled": true, "compiled_code": "\n    select\n        pct_hh_no_vehicle_w as value\n    from `whyline-denver`.`mart_denver`.`mart_vulnerability_by_stop`\n    where 1 = 1\n        and pct_hh_no_vehicle_w < 0\n        and pct_hh_no_vehicle_w > 1\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.833949Z", "completed_at": "2026-02-26T07:02:40.835811Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.836008Z", "completed_at": "2026-02-26T07:02:40.836010Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0024750232696533203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.accepted_range_mart_vulnerability_by_stop_pct_poverty_w__1__0.91b92829ee", "compiled": true, "compiled_code": "\n    select\n        pct_poverty_w as value\n    from `whyline-denver`.`mart_denver`.`mart_vulnerability_by_stop`\n    where 1 = 1\n        and pct_poverty_w < 0\n        and pct_poverty_w > 1\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.836999Z", "completed_at": "2026-02-26T07:02:40.838992Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.839191Z", "completed_at": "2026-02-26T07:02:40.839193Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002684354782104492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.accepted_range_mart_vulnerability_by_stop_pct_transit_commute_w__1__0.e9cf34d391", "compiled": true, "compiled_code": "\n    select\n        pct_transit_commute_w as value\n    from `whyline-denver`.`mart_denver`.`mart_vulnerability_by_stop`\n    where 1 = 1\n        and pct_transit_commute_w < 0\n        and pct_transit_commute_w > 1\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.840086Z", "completed_at": "2026-02-26T07:02:40.841950Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.842138Z", "completed_at": "2026-02-26T07:02:40.842140Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0024690628051757812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.accepted_range_mart_vulnerability_by_stop_vuln_score_0_100__100__0.6d82af62c0", "compiled": true, "compiled_code": "\n    select\n        vuln_score_0_100 as value\n    from `whyline-denver`.`mart_denver`.`mart_vulnerability_by_stop`\n    where 1 = 1\n        and vuln_score_0_100 < 0\n        and vuln_score_0_100 > 100\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.843009Z", "completed_at": "2026-02-26T07:02:40.844791Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.844976Z", "completed_at": "2026-02-26T07:02:40.844978Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023729801177978516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_mart_vulnerability_by_stop_stop_id.89d4da8beb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stop_id\nfrom `whyline-denver`.`mart_denver`.`mart_vulnerability_by_stop`\nwhere stop_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.845867Z", "completed_at": "2026-02-26T07:02:40.848137Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.848335Z", "completed_at": "2026-02-26T07:02:40.848337Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002885103225708008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.relationships_mart_vulnerability_by_stop_stop_id__stop_id__ref_stg_gtfs_stops_.78e02832b6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select stop_id as from_field\n    from `whyline-denver`.`mart_denver`.`mart_vulnerability_by_stop`\n    where stop_id is not null\n),\n\nparent as (\n    select stop_id as to_field\n    from `whyline-denver`.`stg_denver`.`stg_gtfs_stops`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.849215Z", "completed_at": "2026-02-26T07:02:40.850986Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.851174Z", "completed_at": "2026-02-26T07:02:40.851176Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023679733276367188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.unique_mart_vulnerability_by_stop_stop_id.353b4e9688", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select stop_id as unique_field\n  from `whyline-denver`.`mart_denver`.`mart_vulnerability_by_stop`\n  where stop_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.852021Z", "completed_at": "2026-02-26T07:02:40.853501Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.853685Z", "completed_at": "2026-02-26T07:02:40.853687Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002063751220703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.int_stop_headways_scheduled", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n    select\n        route_id,\n        direction_id,\n        stop_id,\n        service_date_mst,\n        sched_arrival_ts_mst\n    from `whyline-denver`.`stg_denver`.`int_scheduled_arrivals`\n    where sched_arrival_ts_mst is not null\n),\ndeduped as (\n    select\n        route_id,\n        direction_id,\n        stop_id,\n        service_date_mst,\n        sched_arrival_ts_mst,\n        row_number() over (\n            partition by route_id, direction_id, stop_id, service_date_mst, sched_arrival_ts_mst\n            order by sched_arrival_ts_mst\n        ) as arrival_rank\n    from base\n)\n\nselect\n    route_id,\n    direction_id,\n    stop_id,\n    service_date_mst,\n    sched_arrival_ts_mst,\n    timestamp_diff(\n        sched_arrival_ts_mst,\n        lag(sched_arrival_ts_mst) over (\n            partition by route_id, direction_id, stop_id, service_date_mst\n            order by sched_arrival_ts_mst\n        ),\n        second\n    ) as sch_headway_sec\nfrom deduped\nwhere arrival_rank = 1", "relation_name": "`whyline-denver`.`stg_denver`.`int_stop_headways_scheduled`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.854546Z", "completed_at": "2026-02-26T07:02:40.859908Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.860126Z", "completed_at": "2026-02-26T07:02:40.860129Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00599980354309082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.stg_rt_events", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith trips as (\n    select\n        trip_id,\n        direction_id,\n        trip_headsign\n    from `whyline-denver`.`stg_denver`.`stg_gtfs_trips`\n),\nscheduled as (\n    select\n        trip_id,\n        stop_id,\n        stop_sequence,\n        sched_arrival_ts_mst,\n        sched_departure_ts_mst,\n        service_date_mst\n    from `whyline-denver`.`stg_denver`.`int_scheduled_arrivals`\n),\ntu as (\n    select\n        feed_ts_utc,\n        entity_id as tu_entity_id,\n        trip_id,\n        route_id,\n        stop_id,\n        stop_sequence,\n        arrival_delay_sec as arrival_delay_sec_raw,\n        departure_delay_sec as departure_delay_sec_raw,\n        schedule_relationship,\n        event_ts_utc as tu_event_ts_utc\n    from `whyline-denver`.`raw_denver`.`raw_gtfsrt_trip_updates`\n    where feed_ts_utc >= timestamp_sub(current_timestamp(), interval 12 hour)\n      and date(feed_ts_utc) >= date_sub(current_date(), interval 1 day)  -- Explicit partition filter\n),\nvp as (\n    select\n        feed_ts_utc,\n        entity_id as vp_entity_id,\n        trip_id,\n        route_id,\n        vehicle_id,\n        vehicle_label,\n        lon,\n        lat,\n        bearing,\n        speed_mps,\n        event_ts_utc as vp_event_ts_utc\n    from `whyline-denver`.`raw_denver`.`raw_gtfsrt_vehicle_positions`\n    where feed_ts_utc >= timestamp_sub(current_timestamp(), interval 12 hour)\n      and date(feed_ts_utc) >= date_sub(current_date(), interval 1 day)  -- Explicit partition filter\n),\nj as (\n    select\n        coalesce(tu.feed_ts_utc, vp.feed_ts_utc) as feed_ts_utc,\n        coalesce(tu.trip_id, vp.trip_id) as trip_id,\n        coalesce(tu.route_id, vp.route_id) as route_id,\n        tu.tu_entity_id,\n        vp.vp_entity_id,\n        tu.stop_id,\n        tu.stop_sequence,\n        tu.arrival_delay_sec_raw,\n        tu.departure_delay_sec_raw,\n        tu.schedule_relationship,\n        vp.vehicle_id,\n        vp.vehicle_label,\n        vp.lon,\n        vp.lat,\n        vp.bearing,\n        vp.speed_mps,\n        \n    ST_GEOGPOINT(CAST(vp.lon AS FLOAT64), CAST(vp.lat AS FLOAT64))\n as geom,\n        coalesce(tu.tu_event_ts_utc, vp.vp_event_ts_utc, coalesce(tu.feed_ts_utc, vp.feed_ts_utc)) as event_ts_utc\n    from tu\n    full outer join vp\n        on tu.feed_ts_utc = vp.feed_ts_utc\n        and tu.trip_id = vp.trip_id\n        and tu.route_id = vp.route_id\n),\nranked as (\n    select\n        *,\n        row_number() over (\n            partition by feed_ts_utc, trip_id\n            order by event_ts_utc desc, tu_entity_id desc, vp_entity_id desc\n        ) as trip_rank\n    from j\n)\nselect\n    r.feed_ts_utc,\n    r.trip_id,\n    r.route_id,\n    r.tu_entity_id,\n    r.vp_entity_id,\n    r.stop_id,\n    r.stop_sequence,\n    -- Use raw delay values if available, otherwise calculate from schedule\n    coalesce(\n        r.arrival_delay_sec_raw,\n        case\n            when s.sched_arrival_ts_mst is not null and r.event_ts_utc is not null\n            then timestamp_diff(r.event_ts_utc, s.sched_arrival_ts_mst, second)\n        end\n    ) as arrival_delay_sec,\n    coalesce(\n        r.departure_delay_sec_raw,\n        case\n            when s.sched_departure_ts_mst is not null and r.event_ts_utc is not null\n            then timestamp_diff(r.event_ts_utc, s.sched_departure_ts_mst, second)\n        end\n    ) as departure_delay_sec,\n    r.schedule_relationship,\n    r.vehicle_id,\n    r.vehicle_label,\n    r.lon,\n    r.lat,\n    r.bearing,\n    r.speed_mps,\n    r.geom,\n    r.event_ts_utc,\n    t.direction_id,\n    t.trip_headsign,\n    \n    DATE(r.event_ts_utc, \"America/Denver\")\n as event_date_mst,\n    \n    EXTRACT(HOUR FROM DATETIME(r.event_ts_utc, \"America/Denver\"))\n as event_hour_mst\nfrom ranked as r\nleft join trips as t\n    on r.trip_id = t.trip_id\nleft join scheduled as s\n    on r.trip_id = s.trip_id\n    and r.stop_id = s.stop_id\n    and r.stop_sequence = s.stop_sequence\n    and s.service_date_mst = \n    DATE(r.event_ts_utc, \"America/Denver\")\n\nwhere r.trip_rank = 1", "relation_name": "`whyline-denver`.`stg_denver`.`stg_rt_events`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.861253Z", "completed_at": "2026-02-26T07:02:40.864432Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.864637Z", "completed_at": "2026-02-26T07:02:40.864640Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003912925720214844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.accepted_range_mart_access_score_by_stop_access_score_0_100__100__0.8ce7af875f", "compiled": true, "compiled_code": "\n    select\n        access_score_0_100 as value\n    from `whyline-denver`.`mart_denver`.`mart_access_score_by_stop`\n    where 1 = 1\n        and access_score_0_100 < 0\n        and access_score_0_100 > 100\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.865544Z", "completed_at": "2026-02-26T07:02:40.867468Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.867665Z", "completed_at": "2026-02-26T07:02:40.867668Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002544879913330078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.accepted_range_mart_access_score_by_stop_sidewalk_len_m_within_200m__0.930c03fe52", "compiled": true, "compiled_code": "\n    select\n        sidewalk_len_m_within_200m as value\n    from `whyline-denver`.`mart_denver`.`mart_access_score_by_stop`\n    where 1 = 1\n        and sidewalk_len_m_within_200m < 0\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.868544Z", "completed_at": "2026-02-26T07:02:40.870361Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.870561Z", "completed_at": "2026-02-26T07:02:40.870563Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0024259090423583984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_mart_access_score_by_stop_stop_id.2857f24b3b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stop_id\nfrom `whyline-denver`.`mart_denver`.`mart_access_score_by_stop`\nwhere stop_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.871454Z", "completed_at": "2026-02-26T07:02:40.873986Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.874219Z", "completed_at": "2026-02-26T07:02:40.874222Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0032122135162353516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.relationships_mart_access_score_by_stop_stop_id__stop_id__ref_stg_gtfs_stops_.fa0fce6e1a", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select stop_id as from_field\n    from `whyline-denver`.`mart_denver`.`mart_access_score_by_stop`\n    where stop_id is not null\n),\n\nparent as (\n    select stop_id as to_field\n    from `whyline-denver`.`stg_denver`.`stg_gtfs_stops`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.875205Z", "completed_at": "2026-02-26T07:02:40.877288Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.877500Z", "completed_at": "2026-02-26T07:02:40.877503Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0027451515197753906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.unique_mart_access_score_by_stop_stop_id.5561394fc8", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select stop_id as unique_field\n  from `whyline-denver`.`mart_denver`.`mart_access_score_by_stop`\n  where stop_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.878536Z", "completed_at": "2026-02-26T07:02:40.880516Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.880741Z", "completed_at": "2026-02-26T07:02:40.880744Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026769638061523438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.int_rt_events_resolved", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        route_id,\n        trip_id,\n        stop_id,\n        direction_id,\n        event_date_mst as service_date_mst,\n        event_hour_mst,\n        event_ts_utc,\n        arrival_delay_sec,\n        departure_delay_sec,\n        coalesce(arrival_delay_sec, departure_delay_sec) as delay_sec_raw,\n        coalesce(arrival_delay_sec, departure_delay_sec, 0) as delay_sec\n    from `whyline-denver`.`stg_denver`.`stg_rt_events`\n)\n\nselect\n    route_id,\n    trip_id,\n    stop_id,\n    direction_id,\n    service_date_mst,\n    event_hour_mst,\n    event_ts_utc,\n    delay_sec,\n    delay_sec_raw,\n    case\n        when abs(delay_sec) <= 300 then 1\n        else 0\n    end as is_on_time\nfrom base", "relation_name": "`whyline-denver`.`stg_denver`.`int_rt_events_resolved`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.881842Z", "completed_at": "2026-02-26T07:02:40.883984Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.884223Z", "completed_at": "2026-02-26T07:02:40.884225Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002899169921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_rt_events_event_ts_utc.f22cf61748", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_ts_utc\nfrom `whyline-denver`.`stg_denver`.`stg_rt_events`\nwhere event_ts_utc is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.885355Z", "completed_at": "2026-02-26T07:02:40.887562Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.887811Z", "completed_at": "2026-02-26T07:02:40.887814Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0029921531677246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_rt_events_feed_ts_utc.775d390db9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect feed_ts_utc\nfrom `whyline-denver`.`stg_denver`.`stg_rt_events`\nwhere feed_ts_utc is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.888833Z", "completed_at": "2026-02-26T07:02:40.891271Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.891507Z", "completed_at": "2026-02-26T07:02:40.891510Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003175020217895508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_rt_events_route_id.0a55159ab0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect route_id\nfrom `whyline-denver`.`stg_denver`.`stg_rt_events`\nwhere route_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.892634Z", "completed_at": "2026-02-26T07:02:40.894869Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.895096Z", "completed_at": "2026-02-26T07:02:40.895100Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0030040740966796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_stg_rt_events_trip_id.f684dd299f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect trip_id\nfrom `whyline-denver`.`stg_denver`.`stg_rt_events`\nwhere trip_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.896276Z", "completed_at": "2026-02-26T07:02:40.899283Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.899514Z", "completed_at": "2026-02-26T07:02:40.899518Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003799915313720703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.relationships_stg_rt_events_route_id__route_id__ref_stg_gtfs_routes_.ad52082e1f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select route_id as from_field\n    from `whyline-denver`.`stg_denver`.`stg_rt_events`\n    where route_id is not null\n),\n\nparent as (\n    select route_id as to_field\n    from `whyline-denver`.`stg_denver`.`stg_gtfs_routes`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.900605Z", "completed_at": "2026-02-26T07:02:40.903130Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.903371Z", "completed_at": "2026-02-26T07:02:40.903375Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003256082534790039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.int_stop_headways_observed", "compiled": true, "compiled_code": "\n\n\n\n\nwith base as (\n    select\n        route_id,\n        direction_id,\n        stop_id,\n        service_date_mst,\n        event_ts_utc\n    from `whyline-denver`.`stg_denver`.`int_rt_events_resolved`\n    where event_ts_utc is not null\n        and service_date_mst >= date_sub(current_date(\"America/Denver\"), interval 45 day)\n),\ndeduped as (\n    select\n        route_id,\n        direction_id,\n        stop_id,\n        service_date_mst,\n        event_ts_utc\n    from (\n        select\n            *,\n            row_number() over (\n                partition by route_id, direction_id, stop_id, service_date_mst, event_ts_utc\n                order by event_ts_utc\n            ) as event_rank\n        from base\n    )\n    where event_rank = 1\n)\n\nselect\n    route_id,\n    direction_id,\n    stop_id,\n    service_date_mst,\n    event_ts_utc,\n    timestamp_diff(\n        event_ts_utc,\n        lag(event_ts_utc) over (\n            partition by route_id, direction_id, stop_id, service_date_mst\n            order by event_ts_utc\n        ),\n        second\n    ) as obs_headway_sec\nfrom deduped", "relation_name": "`whyline-denver`.`stg_denver`.`int_stop_headways_observed`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.904912Z", "completed_at": "2026-02-26T07:02:40.909867Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.910116Z", "completed_at": "2026-02-26T07:02:40.910120Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0060710906982421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.mart_reliability_by_route_day", "compiled": true, "compiled_code": "\n\n\n\nwith e as (\n    select\n        route_id,\n        service_date_mst,\n        delay_sec,\n        delay_sec_raw\n    from `whyline-denver`.`stg_denver`.`int_rt_events_resolved`\n    where true\n    \n        and service_date_mst >= date_sub(current_date(\"America/Denver\"), interval 30 day)\n    \n),\nw as (\n    select\n        service_date_mst,\n        precip_bin,\n        snow_day\n    from `whyline-denver`.`stg_denver`.`int_weather_by_date`\n)\n\nselect\n    e.route_id,\n    e.service_date_mst,\n    coalesce(w.precip_bin, 'none') as precip_bin,\n    coalesce(w.snow_day, false) as snow_day,\n    count(*) as n_events,\n    countif(delay_sec_raw is not null) as n_reported_events,\n    avg(case when abs(delay_sec) <= 300 then 1 else 0 end) as pct_on_time,\n    avg(delay_sec) as mean_delay_sec,\n    approx_quantiles(delay_sec, 100)[offset(50)] as median_delay_sec,\n    approx_quantiles(delay_sec, 100)[offset(90)] as p90_delay_sec,\n    current_timestamp() as build_run_at\nfrom e\nleft join w\n    using (service_date_mst)\ngroup by\n    route_id,\n    service_date_mst,\n    precip_bin,\n    snow_day", "relation_name": "`whyline-denver`.`mart_denver`.`mart_reliability_by_route_day`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.911509Z", "completed_at": "2026-02-26T07:02:40.915104Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.915348Z", "completed_at": "2026-02-26T07:02:40.915352Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004541873931884766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.int_headway_adherence", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith obs as (\n    select\n        route_id,\n        direction_id,\n        stop_id,\n        service_date_mst,\n        event_ts_utc,\n        obs_headway_sec\n    from `whyline-denver`.`stg_denver`.`int_stop_headways_observed`\n    where obs_headway_sec is not null\n    \n        and service_date_mst >= date_sub(current_date(\"America/Denver\"), interval 3 day)\n    \n),\nsch as (\n    select\n        route_id,\n        direction_id,\n        stop_id,\n        service_date_mst,\n        sched_arrival_ts_mst,\n        sch_headway_sec\n    from `whyline-denver`.`stg_denver`.`int_stop_headways_scheduled`\n    where sch_headway_sec is not null\n    \n),\nnearest as (\n    select\n        o.route_id,\n        o.direction_id,\n        o.stop_id,\n        o.service_date_mst,\n        o.event_ts_utc,\n        o.obs_headway_sec,\n        s.sch_headway_sec,\n        abs(timestamp_diff(o.event_ts_utc, s.sched_arrival_ts_mst, second)) as dt_abs\n    from obs as o\n    join sch as s\n        on o.route_id = s.route_id\n        and coalesce(o.direction_id, -1) = coalesce(s.direction_id, -1)\n        and o.stop_id = s.stop_id\n        and o.service_date_mst = s.service_date_mst\n    qualify row_number() over (\n        partition by o.route_id, o.direction_id, o.stop_id, o.service_date_mst, o.event_ts_utc\n        order by dt_abs\n    ) = 1\n)\n\nselect\n    route_id,\n    direction_id,\n    stop_id,\n    service_date_mst,\n    event_ts_utc,\n    obs_headway_sec,\n    sch_headway_sec,\n    dt_abs,\n    case\n        when dt_abs <= 1800\n         and sch_headway_sec > 0\n         and abs(obs_headway_sec - sch_headway_sec) / sch_headway_sec <= 0.5\n        then 1\n        else 0\n    end as headway_adherent\nfrom nearest", "relation_name": "`whyline-denver`.`stg_denver`.`int_headway_adherence`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.916590Z", "completed_at": "2026-02-26T07:02:40.918501Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.918731Z", "completed_at": "2026-02-26T07:02:40.918733Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026819705963134766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.mart_weather_impacts", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        route_id,\n        precip_bin,\n        pct_on_time\n    from `whyline-denver`.`mart_denver`.`mart_reliability_by_route_day`\n),\navgd as (\n    select\n        route_id,\n        precip_bin,\n        avg(pct_on_time) as pct_on_time_avg\n    from base\n    group by\n        route_id,\n        precip_bin\n),\nnorm as (\n    select\n        a.route_id,\n        a.precip_bin,\n        a.pct_on_time_avg,\n        n.pct_on_time_avg as pct_on_time_normal\n    from avgd as a\n    left join avgd as n\n        on a.route_id = n.route_id\n        and n.precip_bin = 'none'\n)\n\nselect\n    route_id,\n    precip_bin,\n    pct_on_time_avg,\n    pct_on_time_normal,\n    pct_on_time_avg - pct_on_time_normal as delta_pct_on_time,\n    current_timestamp() as build_run_at\nfrom norm", "relation_name": "`whyline-denver`.`mart_denver`.`mart_weather_impacts`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.919849Z", "completed_at": "2026-02-26T07:02:40.921871Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.922071Z", "completed_at": "2026-02-26T07:02:40.922073Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026962757110595703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.accepted_range_mart_reliability_by_route_day_pct_on_time__1__0.bce527d1c7", "compiled": true, "compiled_code": "\n    select\n        pct_on_time as value\n    from `whyline-denver`.`mart_denver`.`mart_reliability_by_route_day`\n    where 1 = 1\n        and pct_on_time < 0\n        and pct_on_time > 1\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.923001Z", "completed_at": "2026-02-26T07:02:40.925036Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.925243Z", "completed_at": "2026-02-26T07:02:40.925245Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002674102783203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_mart_reliability_by_route_day_precip_bin.6430d0982c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect precip_bin\nfrom `whyline-denver`.`mart_denver`.`mart_reliability_by_route_day`\nwhere precip_bin is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.926138Z", "completed_at": "2026-02-26T07:02:40.927979Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.928181Z", "completed_at": "2026-02-26T07:02:40.928184Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0024569034576416016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_mart_reliability_by_route_day_route_id.b843d7f52f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect route_id\nfrom `whyline-denver`.`mart_denver`.`mart_reliability_by_route_day`\nwhere route_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.929151Z", "completed_at": "2026-02-26T07:02:40.930982Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.931173Z", "completed_at": "2026-02-26T07:02:40.931176Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0025169849395751953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_mart_reliability_by_route_day_service_date_mst.17009ac7e5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect service_date_mst\nfrom `whyline-denver`.`mart_denver`.`mart_reliability_by_route_day`\nwhere service_date_mst is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.932073Z", "completed_at": "2026-02-26T07:02:40.934358Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.934572Z", "completed_at": "2026-02-26T07:02:40.934575Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002929210662841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.relationships_mart_reliability_by_route_day_route_id__route_id__ref_stg_gtfs_routes_.e3178fa75e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select route_id as from_field\n    from `whyline-denver`.`mart_denver`.`mart_reliability_by_route_day`\n    where route_id is not null\n),\n\nparent as (\n    select route_id as to_field\n    from `whyline-denver`.`stg_denver`.`stg_gtfs_routes`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.935513Z", "completed_at": "2026-02-26T07:02:40.937860Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.938061Z", "completed_at": "2026-02-26T07:02:40.938063Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002989053726196289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.mart_reliability_by_stop_hour", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        stop_id,\n        route_id,\n        service_date_mst,\n        event_hour_mst,\n        delay_sec\n    from `whyline-denver`.`stg_denver`.`int_rt_events_resolved`\n    where stop_id is not null\n    \n        and service_date_mst >= date_sub(current_date(\"America/Denver\"), interval 3 day)\n    \n),\nhead AS (\n    select\n        stop_id,\n        service_date_mst,\n        extract(hour from event_ts_utc at time zone \"America/Denver\") as event_hour_mst,\n        avg(headway_adherent) as headway_adherence_rate,\n        approx_quantiles(obs_headway_sec, 100)[offset(50)] as obs_headway_sec_p50,\n        approx_quantiles(obs_headway_sec, 100)[offset(90)] as obs_headway_sec_p90\n    from `whyline-denver`.`stg_denver`.`int_headway_adherence`\n    group by\n        stop_id,\n        service_date_mst,\n        event_hour_mst\n),\nagg as (\n    select\n        stop_id,\n        service_date_mst,\n        event_hour_mst,\n        count(*) as n_events,\n        avg(case when abs(delay_sec) <= 300 then 1 else 0 end) as pct_on_time,\n        avg(delay_sec) as mean_delay_sec,\n        approx_quantiles(delay_sec, 100)[offset(90)] as p90_delay_sec\n    from base\n    group by\n        stop_id,\n        service_date_mst,\n        event_hour_mst\n),\nroute_mode as (\n    select\n        stop_id,\n        service_date_mst,\n        event_hour_mst,\n        array_agg(route_id order by route_events desc, route_id limit 1)[offset(0)] as route_id_mode\n    from (\n        select\n            stop_id,\n            service_date_mst,\n            event_hour_mst,\n            route_id,\n            count(*) as route_events\n        from base\n        where route_id is not null\n        group by\n            stop_id,\n            service_date_mst,\n            event_hour_mst,\n            route_id\n    )\n    group by\n        stop_id,\n        service_date_mst,\n        event_hour_mst\n)\n\nselect\n    a.stop_id,\n    a.service_date_mst,\n    a.event_hour_mst,\n    a.n_events,\n    a.pct_on_time,\n    a.mean_delay_sec,\n    a.p90_delay_sec,\n    coalesce(rm.route_id_mode, 'unknown') as route_id_mode,\n    h.headway_adherence_rate,\n    h.obs_headway_sec_p50,\n    h.obs_headway_sec_p90,\n    current_timestamp() as build_run_at\nfrom agg as a\nleft join head as h\n    using (stop_id, service_date_mst, event_hour_mst)\nleft join route_mode as rm\n    using (stop_id, service_date_mst, event_hour_mst)", "relation_name": "`whyline-denver`.`mart_denver`.`mart_reliability_by_stop_hour`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.939003Z", "completed_at": "2026-02-26T07:02:40.940842Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.941041Z", "completed_at": "2026-02-26T07:02:40.941043Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002465963363647461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.accepted_range_mart_weather_impacts_pct_on_time_avg__1__0.4786f9d34d", "compiled": true, "compiled_code": "\n    select\n        pct_on_time_avg as value\n    from `whyline-denver`.`mart_denver`.`mart_weather_impacts`\n    where 1 = 1\n        and pct_on_time_avg < 0\n        and pct_on_time_avg > 1\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.941944Z", "completed_at": "2026-02-26T07:02:40.943743Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.943932Z", "completed_at": "2026-02-26T07:02:40.943934Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002413034439086914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.accepted_range_mart_weather_impacts_pct_on_time_normal__1__0.5267f458d5", "compiled": true, "compiled_code": "\n    select\n        pct_on_time_normal as value\n    from `whyline-denver`.`mart_denver`.`mart_weather_impacts`\n    where 1 = 1\n        and pct_on_time_normal < 0\n        and pct_on_time_normal > 1\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.944835Z", "completed_at": "2026-02-26T07:02:40.947878Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.948075Z", "completed_at": "2026-02-26T07:02:40.948077Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036721229553222656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_mart_weather_impacts_precip_bin.1398fc6d5c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect precip_bin\nfrom `whyline-denver`.`mart_denver`.`mart_weather_impacts`\nwhere precip_bin is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.948953Z", "completed_at": "2026-02-26T07:02:40.950744Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.950946Z", "completed_at": "2026-02-26T07:02:40.950948Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0024080276489257812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_mart_weather_impacts_route_id.d198f5d6bc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect route_id\nfrom `whyline-denver`.`mart_denver`.`mart_weather_impacts`\nwhere route_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.951817Z", "completed_at": "2026-02-26T07:02:40.954020Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.954221Z", "completed_at": "2026-02-26T07:02:40.954223Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002811908721923828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.relationships_mart_weather_impacts_route_id__route_id__ref_stg_gtfs_routes_.6b4c0cd147", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select route_id as from_field\n    from `whyline-denver`.`mart_denver`.`mart_weather_impacts`\n    where route_id is not null\n),\n\nparent as (\n    select route_id as to_field\n    from `whyline-denver`.`stg_denver`.`stg_gtfs_routes`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.955100Z", "completed_at": "2026-02-26T07:02:40.956894Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.957083Z", "completed_at": "2026-02-26T07:02:40.957085Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023899078369140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.whyline_denver_dbt.mart_priority_hotspots", "compiled": true, "compiled_code": "\n\nwith rel as (\n    select\n        stop_id,\n        100.0 * (1 - avg(pct_on_time)) as reliability_score_0_100\n    from `whyline-denver`.`mart_denver`.`mart_reliability_by_stop_hour`\n    where service_date_mst >= date_sub(current_date(\"America/Denver\"), interval 35 day)\n    group by stop_id\n),\ncr as (\n    select\n        stop_id,\n        cast(\n            round(\n                (crash_250m_cnt - min(crash_250m_cnt) over ()) /\n                nullif(\n                    max(crash_250m_cnt) over () - min(crash_250m_cnt) over (),\n                    0\n                ) * 100,\n                1\n            ) as float64\n        ) as crash_score_0_100\n    from `whyline-denver`.`mart_denver`.`mart_crash_proximity_by_stop`\n),\nv as (\n    select\n        stop_id,\n        vuln_score_0_100\n    from `whyline-denver`.`mart_denver`.`mart_vulnerability_by_stop`\n),\njoined as (\n    select\n        coalesce(v.stop_id, cr.stop_id, rel.stop_id) as stop_id,\n        v.vuln_score_0_100,\n        cr.crash_score_0_100,\n        rel.reliability_score_0_100\n    from v\n    full outer join cr\n        using (stop_id)\n    full outer join rel\n        using (stop_id)\n),\nscored as (\n    select\n        stop_id,\n        vuln_score_0_100,\n        crash_score_0_100,\n        reliability_score_0_100,\n        0.5 * coalesce(vuln_score_0_100, 0)\n        + 0.3 * coalesce(crash_score_0_100, 0)\n        + 0.2 * coalesce(reliability_score_0_100, 0) as priority_score\n    from joined\n)\n\nselect\n    stop_id,\n    vuln_score_0_100,\n    crash_score_0_100,\n    reliability_score_0_100,\n    priority_score,\n    dense_rank() over (order by priority_score desc) as priority_rank,\n    current_timestamp() as build_run_at\nfrom scored\nwhere stop_id is not null", "relation_name": "`whyline-denver`.`mart_denver`.`mart_priority_hotspots`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.958014Z", "completed_at": "2026-02-26T07:02:40.959832Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.960033Z", "completed_at": "2026-02-26T07:02:40.960036Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002476930618286133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.accepted_range_mart_reliability_by_stop_hour_pct_on_time__1__0.10f5fdfaa3", "compiled": true, "compiled_code": "\n    select\n        pct_on_time as value\n    from `whyline-denver`.`mart_denver`.`mart_reliability_by_stop_hour`\n    where 1 = 1\n        and pct_on_time < 0\n        and pct_on_time > 1\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.960962Z", "completed_at": "2026-02-26T07:02:40.962757Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.962960Z", "completed_at": "2026-02-26T07:02:40.962962Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002424955368041992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_mart_reliability_by_stop_hour_event_hour_mst.92b3494c69", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_hour_mst\nfrom `whyline-denver`.`mart_denver`.`mart_reliability_by_stop_hour`\nwhere event_hour_mst is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.963849Z", "completed_at": "2026-02-26T07:02:40.965622Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.965820Z", "completed_at": "2026-02-26T07:02:40.965822Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023941993713378906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_mart_reliability_by_stop_hour_service_date_mst.8b2405888c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect service_date_mst\nfrom `whyline-denver`.`mart_denver`.`mart_reliability_by_stop_hour`\nwhere service_date_mst is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.966705Z", "completed_at": "2026-02-26T07:02:40.968543Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.968740Z", "completed_at": "2026-02-26T07:02:40.968743Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002465963363647461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_mart_reliability_by_stop_hour_stop_id.fd67b3e72f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stop_id\nfrom `whyline-denver`.`mart_denver`.`mart_reliability_by_stop_hour`\nwhere stop_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.969625Z", "completed_at": "2026-02-26T07:02:40.971867Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.972078Z", "completed_at": "2026-02-26T07:02:40.972081Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0028798580169677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.relationships_mart_reliability_by_stop_hour_stop_id__stop_id__ref_stg_gtfs_stops_.dcfe963153", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select stop_id as from_field\n    from `whyline-denver`.`mart_denver`.`mart_reliability_by_stop_hour`\n    where stop_id is not null\n),\n\nparent as (\n    select stop_id as to_field\n    from `whyline-denver`.`stg_denver`.`stg_gtfs_stops`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.972999Z", "completed_at": "2026-02-26T07:02:40.974789Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.974985Z", "completed_at": "2026-02-26T07:02:40.974987Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0024039745330810547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.accepted_range_mart_priority_hotspots_priority_score__0.2fe9aa30be", "compiled": true, "compiled_code": "\n    select\n        priority_score as value\n    from `whyline-denver`.`mart_denver`.`mart_priority_hotspots`\n    where 1 = 1\n        and priority_score < 0\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.975860Z", "completed_at": "2026-02-26T07:02:40.977667Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.977863Z", "completed_at": "2026-02-26T07:02:40.977865Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002412080764770508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.not_null_mart_priority_hotspots_stop_id.cc9cb33d13", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stop_id\nfrom `whyline-denver`.`mart_denver`.`mart_priority_hotspots`\nwhere stop_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.978773Z", "completed_at": "2026-02-26T07:02:40.981999Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.982212Z", "completed_at": "2026-02-26T07:02:40.982214Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003875255584716797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.relationships_mart_priority_hotspots_stop_id__stop_id__ref_stg_gtfs_stops_.ba07faf7e4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select stop_id as from_field\n    from `whyline-denver`.`mart_denver`.`mart_priority_hotspots`\n    where stop_id is not null\n),\n\nparent as (\n    select stop_id as to_field\n    from `whyline-denver`.`stg_denver`.`stg_gtfs_stops`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-26T07:02:40.983098Z", "completed_at": "2026-02-26T07:02:40.984871Z"}, {"name": "execute", "started_at": "2026-02-26T07:02:40.985061Z", "completed_at": "2026-02-26T07:02:40.985063Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002385854721069336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.whyline_denver_dbt.unique_mart_priority_hotspots_stop_id.3b0b820133", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select stop_id as unique_field\n  from `whyline-denver`.`mart_denver`.`mart_priority_hotspots`\n  where stop_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 1.713494062423706, "args": {"target": "prod", "select": [], "which": "compile", "use_colors": true, "write_json": true, "log_path": "/Users/medsidd/Desktop/whyline-denver/dbt/logs", "invocation_command": "dbt compile --target prod", "print": true, "warn_error_options": {"include": [], "exclude": []}, "macro_debugging": false, "defer": false, "empty": false, "enable_legacy_logger": false, "log_format": "default", "inject_ephemeral_ctes": true, "cache_selected_only": false, "log_file_max_bytes": 10485760, "printer_width": 80, "show_resource_report": false, "profiles_dir": "/Users/medsidd/Desktop/whyline-denver/dbt/profiles", "version_check": true, "favor_state": false, "introspect": true, "quiet": false, "log_level": "info", "vars": {}, "require_resource_names_without_spaces": false, "log_level_file": "debug", "source_freshness_run_project_hooks": false, "use_colors_file": true, "static_parser": true, "strict_mode": false, "indirect_selection": "eager", "output": "text", "partial_parse_file_diff": true, "project_dir": "/Users/medsidd/Desktop/whyline-denver/dbt", "require_explicit_package_overrides_for_builtin_materializations": true, "send_anonymous_usage_stats": true, "partial_parse": true, "log_format_file": "debug", "exclude": [], "populate_cache": true}}